{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"is a specialized \"configuration as a code\" tool for GitLab projects, groups and more using hierarchical configuration written in YAML. Why? \u00b6 Short and powerful syntax \u00b6 A lot of features with a little amount of YAML thanks to the hierarchical configuration with inheritance, merging/overwriting and additivity . # configuration shared by all projects in this group... a_group/* : merge_requests : approvals : approvals_before_merge : 2 # ...except this project that has a different config: a_group/a_special_project : merge_requests : approvals : approvals_before_merge : 1 Dynamic features \u00b6 GitLab introduces new features monthly. You can often use them in GitLabForm without upgrading the app because we pass some parameters as-is to GitLab APIs with PUT/POST requests . a_group/a_project : project_settings : # ALL the keys described at # https://docs.gitlab.com/ee/api/projects.html#edit-project # can be provided here Stability \u00b6 We treat our users the way we would like to be treated by other software projects maintainers: We follow semver and don't allow existing features behavior changes in minor or patch versions. Before changing the syntax we start printing deprecation warnings in the versions before. We use versioning of the configuration syntax for major changes and provide step-by-step upgrade guidelines. Quick start \u00b6 Let's assume that you want to add a deployment key to all projects in a group \"My Group\" (with path \"my-group\"). If so then: Create a config.yml file with: config_version : 3 gitlab : url : https://gitlab.yourcompany.com # alternatively use the GITLAB_TOKEN environment variable for this token : \"<private token OR an OAuth2 access token of an admin user>\" projects_and_groups : my-group/* : deploy_keys : a_friendly_deploy_key_name : # this name is only used in GitLabForm config key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC3WiHAsm2UTz2dU1vKFYUGfHI1p5fIv84BbtV/9jAKvZhVHDqMa07PgVtkttjvDC8bA1kezhOBKcO0KNzVoDp0ENq7WLxFyLFMQ9USf8LmOY70uV/l8Gpcn1ZT7zRBdEzUUgF/PjZukqVtuHqf9TCO8Ekvjag9XRfVNadKs25rbL60oqpIpEUqAbmQ4j6GFcfBBBPuVlKfidI6O039dAnDUsmeafwCOhEvQmF+N5Diauw3Mk+9TMKNlOWM+pO2DKxX9LLLWGVA9Dqr6dWY0eHjWKUmk2B1h1HYW+aUyoWX2TGsVX9DlNY7CKiQGsL5MRH9IXKMQ8cfMweKoEcwSSXJ title : ssh_key_name_that_is_shown_in_gitlab can_push : false 2. Run: docker run -it -v $( pwd ) :/config ghcr.io/gitlabform/gitlabform:latest gitlabform my-group 3. Watch GitLabForm add this deploy key to all projects in \"My Group\" group in your GitLab! Used by \u00b6 ...and many more! License \u00b6 The app code is licensed under the MIT license. A few scripts in dev/ directory are licensed under the MPL 2.0 license. GitLab is a registered trademark of GitLab, Inc. This application is not endorsed by GitLab and is not affiliated with GitLab in any way. The GitLabForm logo is based on the GitLab logos available here , and like the original art is licensed under the Creative Commons Attribution Non-Commercial ShareAlike 4.0 International License . All the logos shown in the \"Home\" section of this documentation belong to their respective owners.","title":"\ud83c\udfd7 GitLabForm"},{"location":"#why","text":"","title":"Why?"},{"location":"#short-and-powerful-syntax","text":"A lot of features with a little amount of YAML thanks to the hierarchical configuration with inheritance, merging/overwriting and additivity . # configuration shared by all projects in this group... a_group/* : merge_requests : approvals : approvals_before_merge : 2 # ...except this project that has a different config: a_group/a_special_project : merge_requests : approvals : approvals_before_merge : 1","title":"Short and powerful syntax"},{"location":"#dynamic-features","text":"GitLab introduces new features monthly. You can often use them in GitLabForm without upgrading the app because we pass some parameters as-is to GitLab APIs with PUT/POST requests . a_group/a_project : project_settings : # ALL the keys described at # https://docs.gitlab.com/ee/api/projects.html#edit-project # can be provided here","title":"Dynamic features"},{"location":"#stability","text":"We treat our users the way we would like to be treated by other software projects maintainers: We follow semver and don't allow existing features behavior changes in minor or patch versions. Before changing the syntax we start printing deprecation warnings in the versions before. We use versioning of the configuration syntax for major changes and provide step-by-step upgrade guidelines.","title":"Stability"},{"location":"#quick-start","text":"Let's assume that you want to add a deployment key to all projects in a group \"My Group\" (with path \"my-group\"). If so then: Create a config.yml file with: config_version : 3 gitlab : url : https://gitlab.yourcompany.com # alternatively use the GITLAB_TOKEN environment variable for this token : \"<private token OR an OAuth2 access token of an admin user>\" projects_and_groups : my-group/* : deploy_keys : a_friendly_deploy_key_name : # this name is only used in GitLabForm config key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC3WiHAsm2UTz2dU1vKFYUGfHI1p5fIv84BbtV/9jAKvZhVHDqMa07PgVtkttjvDC8bA1kezhOBKcO0KNzVoDp0ENq7WLxFyLFMQ9USf8LmOY70uV/l8Gpcn1ZT7zRBdEzUUgF/PjZukqVtuHqf9TCO8Ekvjag9XRfVNadKs25rbL60oqpIpEUqAbmQ4j6GFcfBBBPuVlKfidI6O039dAnDUsmeafwCOhEvQmF+N5Diauw3Mk+9TMKNlOWM+pO2DKxX9LLLWGVA9Dqr6dWY0eHjWKUmk2B1h1HYW+aUyoWX2TGsVX9DlNY7CKiQGsL5MRH9IXKMQ8cfMweKoEcwSSXJ title : ssh_key_name_that_is_shown_in_gitlab can_push : false 2. Run: docker run -it -v $( pwd ) :/config ghcr.io/gitlabform/gitlabform:latest gitlabform my-group 3. Watch GitLabForm add this deploy key to all projects in \"My Group\" group in your GitLab!","title":"Quick start"},{"location":"#used-by","text":"...and many more!","title":"Used by"},{"location":"#license","text":"The app code is licensed under the MIT license. A few scripts in dev/ directory are licensed under the MPL 2.0 license. GitLab is a registered trademark of GitLab, Inc. This application is not endorsed by GitLab and is not affiliated with GitLab in any way. The GitLabForm logo is based on the GitLab logos available here , and like the original art is licensed under the Creative Commons Attribution Non-Commercial ShareAlike 4.0 International License . All the logos shown in the \"Home\" section of this documentation belong to their respective owners.","title":"License"},{"location":"UPGRADING/","text":"Please see the upgrade guide in the new website .","title":"UPGRADING"},{"location":"automation/","text":"Automation \u00b6 Running in an automated pipeline \u00b6 You can use GitLabForm as a part of your CCA (Continuous Configuration Automation) pipeline. You can run it with a schedule on ALL_DEFINED or ALL projects to unify your GitLab configuration, after it may have drifted from the configuration. For example you may allow the users to reconfigure projects during their working hours but automate cleaning up the drift each night. An example .gitlab-ci.yml for running GitLabForm using GitLab CI is provided here: image : ghcr.io/gitlabform/gitlabform:latest some_project : only : changes : - config.yml script : gitlabform my-group/subgroup/project my_whole_other_group : only : changes : - other-config.yml script : gitlabform -c other-config.yml my_whole_other_group Note that as a standard best practice you should not put your GitLab access token in your config.yml (unless it is encrypted) for security reasons - please set it in the GITLAB_TOKEN environment variable instead. For GitLab CI a secure place to set it would be a Protected Variable in the project configuration . Running automatically for new projects \u00b6 (* - Why do we provide a how-to only for the new projects and not groups? Because we assume that there is no big need to automate configuring new groups as if you add a config for a new group to GitLabForm, then it's hard to forget to actually run it...) Using system hooks \u00b6 Probably all the methods to achieve this will use GitLab system hooks feature which makes GitLab perform HTTP POST request on - among other ones - these events: project_create project_rename - we want this because after the rename project may get a new config from GitLabForm, project_transfer - we want this because under a new group the project may get a new config from GitLabForm, Method 1: GitLabForm on the same server as GitLab + adnanh/webhook app \u00b6 In this method we assume that: you have GitLabForm installed on the same server as your GitLab instance. its binary is here: /opt/gitlabform/venv/bin/gitlabform . its config is in /opt/gitlabform/conf - config.yml plus some files for the files: sections. Step 1: Configure GitLab system hooks \u00b6 Go to https://gitlab.your-company.com/admin/hooks and create a hook with the URL http://127.0.0.1:9000/hooks/run-gitlabform . Uncheck all the extra triggers as the events that are interesting for us are among the standard ones. Leave \"Enable SSL verification\" unchecked as we are making calls over loopback, there is no need to encrypt the traffic here. Step 2: Configure the webhook app to run GitLabForm \u00b6 Get and install the adnanh/webhook app. Create this pretty self-explaining config: --- - id : run-gitlabform execute-command : \"/opt/gitlabform/venv/bin/gitlabform\" command-working-directory : \"/opt/gitlabform/conf\" pass-arguments-to-command : - source : payload name : path_with_namespace trigger-rule : match : type : regex regex : \"(project_create|project_rename|project_transfer)\" parameter : source : payload name : event_name ...and save it as hooks.yaml . Run webhook app with: ./webhook -hooks path/to/your/hooks.yaml -ip 127 .0.0.1 -verbose ...and keep it running. (In the long term you should make this permanent with a systemd service/other way appropriate to your distro.) Step 3: Test \u00b6 Create a project with a config defined in your GitLabForm config and watch the output of webhook app. It should look like this: [webhook] 2021/01/25 19:24:56 incoming HTTP request from 127.0.0.1:56822 [webhook] 2021/01/25 19:24:56 run-gitlabform got matched [webhook] 2021/01/25 19:24:56 200 | 180.402\u00b5s | 127.0.0.1:5000 | POST /hooks/run-gitlabform [webhook] 2021/01/25 19:24:58 command output: *** # of groups to process: 0 *** # of projects to process: 1 * [1/1] Processing: your-group/your-project (...) GitLabForm version: 1.20.0 (the latest) [webhook] 2021/01/25 19:24:58 finished handling run-gitlabform - congrats! This means that it works! \ud83c\udf89","title":"\ud83e\udd16 Automation"},{"location":"automation/#automation","text":"","title":"Automation"},{"location":"automation/#running-in-an-automated-pipeline","text":"You can use GitLabForm as a part of your CCA (Continuous Configuration Automation) pipeline. You can run it with a schedule on ALL_DEFINED or ALL projects to unify your GitLab configuration, after it may have drifted from the configuration. For example you may allow the users to reconfigure projects during their working hours but automate cleaning up the drift each night. An example .gitlab-ci.yml for running GitLabForm using GitLab CI is provided here: image : ghcr.io/gitlabform/gitlabform:latest some_project : only : changes : - config.yml script : gitlabform my-group/subgroup/project my_whole_other_group : only : changes : - other-config.yml script : gitlabform -c other-config.yml my_whole_other_group Note that as a standard best practice you should not put your GitLab access token in your config.yml (unless it is encrypted) for security reasons - please set it in the GITLAB_TOKEN environment variable instead. For GitLab CI a secure place to set it would be a Protected Variable in the project configuration .","title":"Running in an automated pipeline"},{"location":"automation/#running-automatically-for-new-projects","text":"(* - Why do we provide a how-to only for the new projects and not groups? Because we assume that there is no big need to automate configuring new groups as if you add a config for a new group to GitLabForm, then it's hard to forget to actually run it...)","title":"Running automatically for new projects"},{"location":"automation/#using-system-hooks","text":"Probably all the methods to achieve this will use GitLab system hooks feature which makes GitLab perform HTTP POST request on - among other ones - these events: project_create project_rename - we want this because after the rename project may get a new config from GitLabForm, project_transfer - we want this because under a new group the project may get a new config from GitLabForm,","title":"Using system hooks"},{"location":"automation/#method-1-gitlabform-on-the-same-server-as-gitlab-adnanhwebhook-app","text":"In this method we assume that: you have GitLabForm installed on the same server as your GitLab instance. its binary is here: /opt/gitlabform/venv/bin/gitlabform . its config is in /opt/gitlabform/conf - config.yml plus some files for the files: sections.","title":"Method 1: GitLabForm on the same server as GitLab + adnanh/webhook app"},{"location":"automation/#step-1-configure-gitlab-system-hooks","text":"Go to https://gitlab.your-company.com/admin/hooks and create a hook with the URL http://127.0.0.1:9000/hooks/run-gitlabform . Uncheck all the extra triggers as the events that are interesting for us are among the standard ones. Leave \"Enable SSL verification\" unchecked as we are making calls over loopback, there is no need to encrypt the traffic here.","title":"Step 1: Configure GitLab system hooks"},{"location":"automation/#step-2-configure-the-webhook-app-to-run-gitlabform","text":"Get and install the adnanh/webhook app. Create this pretty self-explaining config: --- - id : run-gitlabform execute-command : \"/opt/gitlabform/venv/bin/gitlabform\" command-working-directory : \"/opt/gitlabform/conf\" pass-arguments-to-command : - source : payload name : path_with_namespace trigger-rule : match : type : regex regex : \"(project_create|project_rename|project_transfer)\" parameter : source : payload name : event_name ...and save it as hooks.yaml . Run webhook app with: ./webhook -hooks path/to/your/hooks.yaml -ip 127 .0.0.1 -verbose ...and keep it running. (In the long term you should make this permanent with a systemd service/other way appropriate to your distro.)","title":"Step 2: Configure the webhook app to run GitLabForm"},{"location":"automation/#step-3-test","text":"Create a project with a config defined in your GitLabForm config and watch the output of webhook app. It should look like this: [webhook] 2021/01/25 19:24:56 incoming HTTP request from 127.0.0.1:56822 [webhook] 2021/01/25 19:24:56 run-gitlabform got matched [webhook] 2021/01/25 19:24:56 200 | 180.402\u00b5s | 127.0.0.1:5000 | POST /hooks/run-gitlabform [webhook] 2021/01/25 19:24:58 command output: *** # of groups to process: 0 *** # of projects to process: 1 * [1/1] Processing: your-group/your-project (...) GitLabForm version: 1.20.0 (the latest) [webhook] 2021/01/25 19:24:58 finished handling run-gitlabform - congrats! This means that it works! \ud83c\udf89","title":"Step 3: Test"},{"location":"changelog/","text":"Changelog \u00b6 3.3.2 \u00b6 Don't strip trailing new lines from files. Fixes #451 , PR #452 . 3.3.1 \u00b6 Fix for setting deploy key in some cases fail with HTTP 400: {\"fingerprint\":[\"has already been taken\"]} . Fixes #19 , PR #441 . 3.4.0rc1 \u00b6 Add support for multiple merge request approval rules and for changing the name of the currently managed single approval rule . Implements #388 and #95 , PR #435 . The syntax for this feature is shown here for now - it will be moved to the GitHub Pages docs before the final release of v3.4.0. (For contributors) Big refactoring to make the code more logically groupped and contribution documentation updates for easier contributions. Please see the commit messages in the PR #431 for more information. 3.3.0 \u00b6 Add support for managing project Protected environments . PR #423 & PR #430 Add support for Python 3.11 and switch to this version in the Docker image. (For contributors) Move all the GitLabForm tests that require GitLab Premium license into a separate module and introduce a new GitHub Actions flow to enable running them for PRs after the maintainer's approval. Thanks to Rafael Zanella for his contributions! 3.2.0 \u00b6 Add authoritative mode ( enforce: true ) support to group badges, group LDAP links, group variables, badges, deploy keys, variables. Implements #403 , PR #419 . 3.1.2 \u00b6 Make setting project-level CI/CI variables with a non-default different environment_scope work again. Fixes #411 , PR #414 . 3.1.1 \u00b6 Fixed error when passing the GitLab token in the config file with single or double quotes. Fixes #401 , PR #412 . 3.1.0 \u00b6 Add support for Resource groups . Implements #341 . PR #369 . Fix Integrations documentation. PR #402 . Thanks to @ep-linden from Elastic Path and to @L154x for their contribution! 3.0.0 \u00b6 This is a major new version with some backward incompatibility. Please follow the upgrade guide for a fast and safe upgrade. New features/bugfixes: Subgroups now do inherit the settings from their groups. It should have worked like this already, but it did not because of a bug #372 fixed in PR #385 . (Please use inherit: false to keep the old behavior. See the upgrade guide for more info.), Shorter and easier to read errors (full stacktrace shown only when --debug is enabled), Backward-incompatible maintenance changes: Require GitLab version >= 14.4 (released in Oct 2021) as it contains the required API rename , Require Python version >= 3.7 (as 3.6 is EOL since Dec 2021) and update many dependencies that have required it, Drop support for a lot of deprecated configuration syntax that the app has warned about: branch protection - no more developers_can_push , developers_can_merge , use push_access_level , merge_access_level etc. instead, group members - no more group_shared_with , enforce_group_members , group_access_level , use group_members , group_members.enforce , group_access instead, services/integrations - no more recreate , Rename some configuration sections following the renames made in GitLab: services -> integrations , secret_variables -> variables , group_secret_variables -> group_variables , Drop the Debian-based Docker image (it's practically unused - you can maintain your own, if you needed it), (For users of this app as a library) Rename some API methods, remove deprecated ones: protect_branch() is now the method using the new API, the method using the old one has been removed, branch_code_owner_approval_required() -> set_branch_code_owner_approval_required() . delete_legacy_approvers() has been removed, all the methods with service(s) / secret_variable(s) / group_secret_variable(s) in their names have been renamed to contain integration(s) / variable(s) / group_variables(s) . Thanks to the contributors of this release: @ep-linden from Elastic Path . 2.12.0 \u00b6 Update base Docker images: from Python 3.9 and Alpine 3.14 to Python 3.10 and Alpine 3.16, from Python 3.9 and Debian 10 (Buster) to Python 3.10 and Debian 11 (Bullseye). Fix Group CI/CD Variables not honoring protected and masked values set to false . Fixes #384 . 2.11.1post3 \u00b6 Moved the project from gitlabform/gitlabform to gitlabform/gitlabform . Stopped publishing new images to the old egnyte/gitlabform Docker registry. 2.11.1 \u00b6 Fix another case of GitLab's Schedules API change/bug. Fixes #364 . 2.11.0 \u00b6 Allow breaking configuration inheritance . Implements #326 . PR #339 . Imagine you have a configuration like this: projects_and_groups : my-group/* : members : enforce : true groups : regular-developers : group_access : developer my-group/special-private-project : members : inherit : false # <--- the new keyword enforce : true groups : special-developers : group_access : developer users : john : access_level : maintainer With the new inherit: false entry used here, the effective members for my-group/special-private-project project are ONLY the special-developers grup and john user. Always expect pagination for GETs. Fixes #354 . PR #358 . Workaround for the GitLab's Schedules API change/bug. Fixes #361 . Big thanks to the Elastic Path team for their contribution of the above feature, especially @ep-linden for the whole implementation and @amimas for the initial proposal and cooperation on design! (There were 4 pre-releases of this version, 2.11.0b1-b4. b1 contained \"Allow breaking configuration inheritance\", b2 also #358 , b3 also a fix of a bug that caused breaking config inheritance to not work in some cases, b4 - #361 ). 2.10.1 \u00b6 Fix a problem causing some changes to not be applied. Fixes #334 . PR #350 . 2.10.0 \u00b6 Deleting deploy keys is now possible . This partially implements #193 . Also completely replace the implementation of deploy keys, secret variables and group secret variables with a new universal one. This possibly fixes #19 . Up to 40% faster thanks to making less requests to GitLab. (For almost 1000 repositories the apply time has dropped from ~18 minutes to ~11 minutes.) With debug enabled a lot less duplication and a more readable output of dicts (shown as JSONs). For Contributors Introduce SingleEntityProcessor that generalizes editing things that are single per project, f.e. settings or push rules set. It does not edit entities if there are not changes to be applied. Using it implementing new features can be superfast! (See also MultipleEntitiesProcessor added in v2.2.0). For Contributors Faster tests and improved usage of fixtures. (A pre-release of 2.9.2 RC1 contained some of the above changes. 2.10.0rc1 pre-release was the same as 2.10.0 final but with a slightly different changelog - the speed gains turned out to be higher than expected.) 2.9.1 \u00b6 Fix version 2.9.0 not even starting. \ud83e\udd26\u200d\u2642\ufe0f Add test to prevent this from happening again. 2.9.0 \u00b6 Access level names (not only their numbers) are now accepted in the configuration . More strictness in parsing configuration YAML and better error messages thanks to a switch to different libraries. F.e. hash keys overwriting is not accepted anymore. Moved the project from egnyte/gitlabform to gitlabform/gitlabform and switch to GitHub Registry as the new main Docker registry. 2.8.1 \u00b6 Don't show \"Warning: Using group_shared_with: is deprecated\" although the user is not really using this config syntax. 2.8.0 \u00b6 Complete support for managing groups and projects members : Add enforcing (direct) project members - groups and users, including being able to remove all direct members and keep only the members inherited from the group. Implements #100 . Unify the configuration syntax for group and project level membership. \u2728 New \u2728 config syntax example: projects_and_groups : foo/* : # below key now includes what used to be under # `group_shared_with` and `enforce_group_members` keys group_members : # there are only up to 3 direct keys below groups : another-group : # below key's name been changed to the name used in projects `members` # for groups (and the same as in the API to share group with group) group_access : 30 users : my-user : access_level : 50 # owner # this will enforce group-level users to be ONLY as defined above enforce : true # this will make the projects in `foo` group not contain any **direct** users or groups other # (so it will make it contain only the ones inherited from the group `foo`) members : enforce : true The \ud83c\udfda old and deprecated \ud83c\udfda syntax for a similar* config would be: projects_and_groups : foo/* : group_shared_with : groups : another-group : group_access_level : 30 group_members : my-user : access_level : 50 # owner enforce_group_members : true # !!! * - there was no enforce project members support before v2.8.0 !!! The old syntax works but will generate warnings. Support for it will be removed in one the future major GitLabForm versions. 2.7.1 \u00b6 Speed up running for ALL_DEFINED , when the defined groups and projects for just a small part of all the GitLab instance's groups and projects. Additionally always show the number of omitted groups and projects for any reasons (no config, archived, skipped). Fixes #285 . 2.7.0 \u00b6 Allow processing only requested configuration sections using a new cli argument -os / --only-sections . Minimize the number of unnecessary audit branch unprotect/protect events. Up to now every apply of the files section for protected branch resulted in unprotect and then (re)protect event for each protected branches and each file. Now this will only happen when the user running GitLabForm actually needs to do that, which should not happen often if you are using an admin account. Completely fixes #178 . 2.6.0 \u00b6 Complete support for Protected branches - access levels / users / groups allowed to push/merge/unprotect ( GitLab Premium (paid) only ). PR #289 . Add option to allow push force in protected branches . Implements #227 . Fix a bug causing the app to get HTTP 502 from GitLab when protecting branches in some cases. Fix getting members list to include usernames of all direct members not just the first page. PR #284 . Big thanks to the contributors of this release: @trissanen 2.5.0 \u00b6 Make commit messages for file operations configurable. Implements #278 . Thanks to @aleung for his contribution! 2.4.0 \u00b6 Add wildcard support for skip_groups and skip_projects . Implements #275 and #276 . Thanks to @chris-workingmouse for his contribution! 2.3.0 \u00b6 Add Protected branches - users allowed to push/merge ( GitLab Premium (paid) only ), PR #273 . For ALL_DEFINED also skip archived projects even if they are explicitly defined in the config, unless -a flag is added - for consistency. For Contributors Add docs for running the test themselves in a Docker container and for running GitLab in Docker using a license file, for testing paid-only features. Thanks to @florentio , @barryib and @Pigueiras for their contribution! 2.2.0 \u00b6 Add LDAP Group Links support ( GitLab Premium (paid) only ). Implements #140 . Add project and group badges support . Implements #59 . Allow 0 (no access) in Protected Tags. Fixes #172 . Exit on configuration missing projects_and_groups key. This will provide a helpful error message for typos made in this key. Fixes #242 . Make error messages more friendly when there is no network connection or when configuration is invalid (f.e. YAML parsing errors). Make the output of some processors a bit more consistent. Fix detecting an \"empty effective config\" and improve the UI related to processing groups and projects with such. Fixes #251 . Big refactoring that should make adding new features easier and faster. The main change is introducing a new way to implement \"processors\" - thanks to a generalized MultipleEntitiesProcessor class adding a new feature like Project Badges should is now as easy as implementing a class like BadgesProcessor and writing an acceptance test like TestBadges . Note that this new design may change in the near future and we are open to discussions and PRs to make it even better! We also plan to create a similar generalized SingleEntityProcessor class soon. Change the User Agent that the app uses when making requests to GitLab to a custom GitLabForm/<gitlabform_version> (python-requests/<requests_version>) . 2.1.2 \u00b6 Managing project members is not incredibly slow anymore. Fixes #240 Thanks to @andrewjw (Ocado Technology) for his contribution! 2.1.1 \u00b6 Fixed sharing group with a subgroup. Fixes #236 Improved re-protecting branches after updating files in them. Fail fast if the config is invalid. Better Docker images: Updated Alpine from 3.12 to 3.14, Started to build images in ARM64 architecture (apart from x86-64), Started to add tags , . . Note that Alpine-based image is the main one which gets these tags. For Debian-based images add \"-buster\" suffix. Implements #173 Thanks to @andrewjw (Ocado Technology) for his contribution! 2.1.0 \u00b6 Added a feature to share groups with other groups, with optional enforcing. Implements #150 Thanks to @andrewjw (Ocado Technology) for this contribution! 2.0.6 \u00b6 Fixed incorrect subgroups list when requesting to process ALL_DEFINED. Completes the fix for #221 2.0.5 \u00b6 Really fixed issue with unprotect_branch_new_api . Fixes #219 Fixed call to a Merge Requests Approvers API endpoint removed in GitLab 13.11.0. Fixes #220 Fixed potential security issue by enabling autoescaping when loading Jinja templates. (Bandit security tool issue B701 ) Thanks to @Pigueiras for his contribution! 2.0.4 \u00b6 Fixed issue with Push Rules when the project name contains a dot. Fixes #224 Fixed calling to process a single subgroup (like: gitlabform 'group/subgroup' ). Fixes #221 2.0.3 \u00b6 Fixed issue with dry-run for Project Push Rules when the current config is empty ( None ). Fixes #223 2.0.2 \u00b6 Fixed issue with unprotect_branch_new_api . Fixes #219 (update: later it turned out that it was not really fixed in 2.0.2 but in 2.0.5 instead) 2.0.1 \u00b6 Fixed issues with Jinja loader. Fixed calls to GitLab API that do not contain 'x-total-pages' header (gradually rolled out since GitLab MR #23931 ). Start showing deprecation warning when using the old branch protection API config syntax. Thanks to @mkjmdski for his contribution! (2.0.0post1-3 release is technically the same as 2.0.1 but was incorrectly versioned.) 2.0.0 \u00b6 (For a detailed info about changes in each RC of v2 please see the previous version of this changelog.) Make deep merging of configuration actually work (breaking change). Fixes #197 (RC5) Introduce config versioning (breaking change). ...or rather a change to avoid breakage. New major releases of GitLabForm starting with v2 will look for config_version key in the config file. If it doesn't exist, or the version does not match expected then the app will exit to avoid applying unexpected configuration and allowing the user to update the configuration. (RC1) New config syntax (breaking change). All 3 levels under a common key projects_and_groups . It should contain a dict, where common config is under a special \"*\" key, group configs under keys like group/* and project configs under keys like group/project . This will allow introducing pattern matching in these keys and introducing support for multiple config files in the future releases. Partially implements #138 . (RC1) Exit with code != 0 when any group/project processing was failed (breaking change). This will allow you to notice problems when running the app from CI. Note that you can restore the old behaviour by running the app with (...) || true . Also standardized exit codes. Exit with 1 in case of input error (f.e. config file does not exist), with 2 in case of processing error (f.e. GitLab returns HTTP 500).Fixes #153 . (RC1) Allow any case in groups and projects names (breaking change). GitLab groups and projects names are case sensitive but you cannot create such entities that differ only in the case. There is also a distinction between a \"name\" and a \"path\" and they may differ in case... To make work with this easier GitLabForm now accepts any case for them in both config files as well as when provided as command line arguments. We also disallow such entities that differ only in case (f.e. group/* and GROUP/* ) to avoid ambiguity. Fixes #160 . (RC2) Ignore archived projects by default (breaking change). This makes processing faster and output shorter. You can restore the previous behavior by adding --include-archived-projects / -a command line switch. Note that you have to do it if you want to unarchive archived projects! Fixes #157 in (arguably) a more convenient way. (RC2) Color output! Implements #141 . (RC1) Add diffing feature for secret variables. (with values shown as hashes to protect the secrets from leaking). (RC6) Added checking for invalid syntax in \"members\" section. Defining groups or users directly under this key instead of under sub-keys \"users\" and \"groups\" will now trigger an immediate error. (RC5) Add support for Python 3.9 (RC8) Added Windows support. Fixes #206 (RC5) Start processing at any group using the new command line switch - --start-from-group / -sfg . Similar to --start-from / -sf switch that can be used for projects. (RC1) Start releasing pre-releases as Docker images. They have tags with specific versions, but not \"latest\" tag as it is reserved for new final releases. Implements #201 (RC5) Prevent multiple email notifications from being sent when adding members to project. Fixes #101 (RC6) Prevent project's Audit Events being filled in with \"Added protected branch\". Fixes #178 (RC6) Fixed using \"expires_at\" for users. Fixes #207 (RC6) Remove the need to add the gitlab.api_version configuration key. (RC1) For Contributors Make writing tests easier and the tests more robust. Deduplicate a lot of the boilerplate code, allow putting configs into the test methods and use pytest fixtures for easier setup and cleanup. This should fix issues with tests reported in #190 . Also stop storing any dockerized GitLab data permanently to avoid problems like #196 and probably other related to failed dockerized GitLab upgrades. (RC3) For Contributors Rename \"integration tests\" to \"acceptance tests\". Because they ARE in fact acceptance tests. (RC3) Thanks to @amimas , @weakcamel , @kowpatryk , @ss7548 , @houres , @Pigueiras and @YuraBeznos for their contributions! before 2.0.0 \u00b6 Please see GitHub pre-2.0 releases' descriptions .","title":"\ud83d\uddd3 Changelog"},{"location":"changelog/#changelog","text":"","title":"Changelog"},{"location":"changelog/#332","text":"Don't strip trailing new lines from files. Fixes #451 , PR #452 .","title":"3.3.2"},{"location":"changelog/#331","text":"Fix for setting deploy key in some cases fail with HTTP 400: {\"fingerprint\":[\"has already been taken\"]} . Fixes #19 , PR #441 .","title":"3.3.1"},{"location":"changelog/#340rc1","text":"Add support for multiple merge request approval rules and for changing the name of the currently managed single approval rule . Implements #388 and #95 , PR #435 . The syntax for this feature is shown here for now - it will be moved to the GitHub Pages docs before the final release of v3.4.0. (For contributors) Big refactoring to make the code more logically groupped and contribution documentation updates for easier contributions. Please see the commit messages in the PR #431 for more information.","title":"3.4.0rc1"},{"location":"changelog/#330","text":"Add support for managing project Protected environments . PR #423 & PR #430 Add support for Python 3.11 and switch to this version in the Docker image. (For contributors) Move all the GitLabForm tests that require GitLab Premium license into a separate module and introduce a new GitHub Actions flow to enable running them for PRs after the maintainer's approval. Thanks to Rafael Zanella for his contributions!","title":"3.3.0"},{"location":"changelog/#320","text":"Add authoritative mode ( enforce: true ) support to group badges, group LDAP links, group variables, badges, deploy keys, variables. Implements #403 , PR #419 .","title":"3.2.0"},{"location":"changelog/#312","text":"Make setting project-level CI/CI variables with a non-default different environment_scope work again. Fixes #411 , PR #414 .","title":"3.1.2"},{"location":"changelog/#311","text":"Fixed error when passing the GitLab token in the config file with single or double quotes. Fixes #401 , PR #412 .","title":"3.1.1"},{"location":"changelog/#310","text":"Add support for Resource groups . Implements #341 . PR #369 . Fix Integrations documentation. PR #402 . Thanks to @ep-linden from Elastic Path and to @L154x for their contribution!","title":"3.1.0"},{"location":"changelog/#300","text":"This is a major new version with some backward incompatibility. Please follow the upgrade guide for a fast and safe upgrade. New features/bugfixes: Subgroups now do inherit the settings from their groups. It should have worked like this already, but it did not because of a bug #372 fixed in PR #385 . (Please use inherit: false to keep the old behavior. See the upgrade guide for more info.), Shorter and easier to read errors (full stacktrace shown only when --debug is enabled), Backward-incompatible maintenance changes: Require GitLab version >= 14.4 (released in Oct 2021) as it contains the required API rename , Require Python version >= 3.7 (as 3.6 is EOL since Dec 2021) and update many dependencies that have required it, Drop support for a lot of deprecated configuration syntax that the app has warned about: branch protection - no more developers_can_push , developers_can_merge , use push_access_level , merge_access_level etc. instead, group members - no more group_shared_with , enforce_group_members , group_access_level , use group_members , group_members.enforce , group_access instead, services/integrations - no more recreate , Rename some configuration sections following the renames made in GitLab: services -> integrations , secret_variables -> variables , group_secret_variables -> group_variables , Drop the Debian-based Docker image (it's practically unused - you can maintain your own, if you needed it), (For users of this app as a library) Rename some API methods, remove deprecated ones: protect_branch() is now the method using the new API, the method using the old one has been removed, branch_code_owner_approval_required() -> set_branch_code_owner_approval_required() . delete_legacy_approvers() has been removed, all the methods with service(s) / secret_variable(s) / group_secret_variable(s) in their names have been renamed to contain integration(s) / variable(s) / group_variables(s) . Thanks to the contributors of this release: @ep-linden from Elastic Path .","title":"3.0.0"},{"location":"changelog/#2120","text":"Update base Docker images: from Python 3.9 and Alpine 3.14 to Python 3.10 and Alpine 3.16, from Python 3.9 and Debian 10 (Buster) to Python 3.10 and Debian 11 (Bullseye). Fix Group CI/CD Variables not honoring protected and masked values set to false . Fixes #384 .","title":"2.12.0"},{"location":"changelog/#2111post3","text":"Moved the project from gitlabform/gitlabform to gitlabform/gitlabform . Stopped publishing new images to the old egnyte/gitlabform Docker registry.","title":"2.11.1post3"},{"location":"changelog/#2111","text":"Fix another case of GitLab's Schedules API change/bug. Fixes #364 .","title":"2.11.1"},{"location":"changelog/#2110","text":"Allow breaking configuration inheritance . Implements #326 . PR #339 . Imagine you have a configuration like this: projects_and_groups : my-group/* : members : enforce : true groups : regular-developers : group_access : developer my-group/special-private-project : members : inherit : false # <--- the new keyword enforce : true groups : special-developers : group_access : developer users : john : access_level : maintainer With the new inherit: false entry used here, the effective members for my-group/special-private-project project are ONLY the special-developers grup and john user. Always expect pagination for GETs. Fixes #354 . PR #358 . Workaround for the GitLab's Schedules API change/bug. Fixes #361 . Big thanks to the Elastic Path team for their contribution of the above feature, especially @ep-linden for the whole implementation and @amimas for the initial proposal and cooperation on design! (There were 4 pre-releases of this version, 2.11.0b1-b4. b1 contained \"Allow breaking configuration inheritance\", b2 also #358 , b3 also a fix of a bug that caused breaking config inheritance to not work in some cases, b4 - #361 ).","title":"2.11.0"},{"location":"changelog/#2101","text":"Fix a problem causing some changes to not be applied. Fixes #334 . PR #350 .","title":"2.10.1"},{"location":"changelog/#2100","text":"Deleting deploy keys is now possible . This partially implements #193 . Also completely replace the implementation of deploy keys, secret variables and group secret variables with a new universal one. This possibly fixes #19 . Up to 40% faster thanks to making less requests to GitLab. (For almost 1000 repositories the apply time has dropped from ~18 minutes to ~11 minutes.) With debug enabled a lot less duplication and a more readable output of dicts (shown as JSONs). For Contributors Introduce SingleEntityProcessor that generalizes editing things that are single per project, f.e. settings or push rules set. It does not edit entities if there are not changes to be applied. Using it implementing new features can be superfast! (See also MultipleEntitiesProcessor added in v2.2.0). For Contributors Faster tests and improved usage of fixtures. (A pre-release of 2.9.2 RC1 contained some of the above changes. 2.10.0rc1 pre-release was the same as 2.10.0 final but with a slightly different changelog - the speed gains turned out to be higher than expected.)","title":"2.10.0"},{"location":"changelog/#291","text":"Fix version 2.9.0 not even starting. \ud83e\udd26\u200d\u2642\ufe0f Add test to prevent this from happening again.","title":"2.9.1"},{"location":"changelog/#290","text":"Access level names (not only their numbers) are now accepted in the configuration . More strictness in parsing configuration YAML and better error messages thanks to a switch to different libraries. F.e. hash keys overwriting is not accepted anymore. Moved the project from egnyte/gitlabform to gitlabform/gitlabform and switch to GitHub Registry as the new main Docker registry.","title":"2.9.0"},{"location":"changelog/#281","text":"Don't show \"Warning: Using group_shared_with: is deprecated\" although the user is not really using this config syntax.","title":"2.8.1"},{"location":"changelog/#280","text":"Complete support for managing groups and projects members : Add enforcing (direct) project members - groups and users, including being able to remove all direct members and keep only the members inherited from the group. Implements #100 . Unify the configuration syntax for group and project level membership. \u2728 New \u2728 config syntax example: projects_and_groups : foo/* : # below key now includes what used to be under # `group_shared_with` and `enforce_group_members` keys group_members : # there are only up to 3 direct keys below groups : another-group : # below key's name been changed to the name used in projects `members` # for groups (and the same as in the API to share group with group) group_access : 30 users : my-user : access_level : 50 # owner # this will enforce group-level users to be ONLY as defined above enforce : true # this will make the projects in `foo` group not contain any **direct** users or groups other # (so it will make it contain only the ones inherited from the group `foo`) members : enforce : true The \ud83c\udfda old and deprecated \ud83c\udfda syntax for a similar* config would be: projects_and_groups : foo/* : group_shared_with : groups : another-group : group_access_level : 30 group_members : my-user : access_level : 50 # owner enforce_group_members : true # !!! * - there was no enforce project members support before v2.8.0 !!! The old syntax works but will generate warnings. Support for it will be removed in one the future major GitLabForm versions.","title":"2.8.0"},{"location":"changelog/#271","text":"Speed up running for ALL_DEFINED , when the defined groups and projects for just a small part of all the GitLab instance's groups and projects. Additionally always show the number of omitted groups and projects for any reasons (no config, archived, skipped). Fixes #285 .","title":"2.7.1"},{"location":"changelog/#270","text":"Allow processing only requested configuration sections using a new cli argument -os / --only-sections . Minimize the number of unnecessary audit branch unprotect/protect events. Up to now every apply of the files section for protected branch resulted in unprotect and then (re)protect event for each protected branches and each file. Now this will only happen when the user running GitLabForm actually needs to do that, which should not happen often if you are using an admin account. Completely fixes #178 .","title":"2.7.0"},{"location":"changelog/#260","text":"Complete support for Protected branches - access levels / users / groups allowed to push/merge/unprotect ( GitLab Premium (paid) only ). PR #289 . Add option to allow push force in protected branches . Implements #227 . Fix a bug causing the app to get HTTP 502 from GitLab when protecting branches in some cases. Fix getting members list to include usernames of all direct members not just the first page. PR #284 . Big thanks to the contributors of this release: @trissanen","title":"2.6.0"},{"location":"changelog/#250","text":"Make commit messages for file operations configurable. Implements #278 . Thanks to @aleung for his contribution!","title":"2.5.0"},{"location":"changelog/#240","text":"Add wildcard support for skip_groups and skip_projects . Implements #275 and #276 . Thanks to @chris-workingmouse for his contribution!","title":"2.4.0"},{"location":"changelog/#230","text":"Add Protected branches - users allowed to push/merge ( GitLab Premium (paid) only ), PR #273 . For ALL_DEFINED also skip archived projects even if they are explicitly defined in the config, unless -a flag is added - for consistency. For Contributors Add docs for running the test themselves in a Docker container and for running GitLab in Docker using a license file, for testing paid-only features. Thanks to @florentio , @barryib and @Pigueiras for their contribution!","title":"2.3.0"},{"location":"changelog/#220","text":"Add LDAP Group Links support ( GitLab Premium (paid) only ). Implements #140 . Add project and group badges support . Implements #59 . Allow 0 (no access) in Protected Tags. Fixes #172 . Exit on configuration missing projects_and_groups key. This will provide a helpful error message for typos made in this key. Fixes #242 . Make error messages more friendly when there is no network connection or when configuration is invalid (f.e. YAML parsing errors). Make the output of some processors a bit more consistent. Fix detecting an \"empty effective config\" and improve the UI related to processing groups and projects with such. Fixes #251 . Big refactoring that should make adding new features easier and faster. The main change is introducing a new way to implement \"processors\" - thanks to a generalized MultipleEntitiesProcessor class adding a new feature like Project Badges should is now as easy as implementing a class like BadgesProcessor and writing an acceptance test like TestBadges . Note that this new design may change in the near future and we are open to discussions and PRs to make it even better! We also plan to create a similar generalized SingleEntityProcessor class soon. Change the User Agent that the app uses when making requests to GitLab to a custom GitLabForm/<gitlabform_version> (python-requests/<requests_version>) .","title":"2.2.0"},{"location":"changelog/#212","text":"Managing project members is not incredibly slow anymore. Fixes #240 Thanks to @andrewjw (Ocado Technology) for his contribution!","title":"2.1.2"},{"location":"changelog/#211","text":"Fixed sharing group with a subgroup. Fixes #236 Improved re-protecting branches after updating files in them. Fail fast if the config is invalid. Better Docker images: Updated Alpine from 3.12 to 3.14, Started to build images in ARM64 architecture (apart from x86-64), Started to add tags , . . Note that Alpine-based image is the main one which gets these tags. For Debian-based images add \"-buster\" suffix. Implements #173 Thanks to @andrewjw (Ocado Technology) for his contribution!","title":"2.1.1"},{"location":"changelog/#210","text":"Added a feature to share groups with other groups, with optional enforcing. Implements #150 Thanks to @andrewjw (Ocado Technology) for this contribution!","title":"2.1.0"},{"location":"changelog/#206","text":"Fixed incorrect subgroups list when requesting to process ALL_DEFINED. Completes the fix for #221","title":"2.0.6"},{"location":"changelog/#205","text":"Really fixed issue with unprotect_branch_new_api . Fixes #219 Fixed call to a Merge Requests Approvers API endpoint removed in GitLab 13.11.0. Fixes #220 Fixed potential security issue by enabling autoescaping when loading Jinja templates. (Bandit security tool issue B701 ) Thanks to @Pigueiras for his contribution!","title":"2.0.5"},{"location":"changelog/#204","text":"Fixed issue with Push Rules when the project name contains a dot. Fixes #224 Fixed calling to process a single subgroup (like: gitlabform 'group/subgroup' ). Fixes #221","title":"2.0.4"},{"location":"changelog/#203","text":"Fixed issue with dry-run for Project Push Rules when the current config is empty ( None ). Fixes #223","title":"2.0.3"},{"location":"changelog/#202","text":"Fixed issue with unprotect_branch_new_api . Fixes #219 (update: later it turned out that it was not really fixed in 2.0.2 but in 2.0.5 instead)","title":"2.0.2"},{"location":"changelog/#201","text":"Fixed issues with Jinja loader. Fixed calls to GitLab API that do not contain 'x-total-pages' header (gradually rolled out since GitLab MR #23931 ). Start showing deprecation warning when using the old branch protection API config syntax. Thanks to @mkjmdski for his contribution! (2.0.0post1-3 release is technically the same as 2.0.1 but was incorrectly versioned.)","title":"2.0.1"},{"location":"changelog/#200","text":"(For a detailed info about changes in each RC of v2 please see the previous version of this changelog.) Make deep merging of configuration actually work (breaking change). Fixes #197 (RC5) Introduce config versioning (breaking change). ...or rather a change to avoid breakage. New major releases of GitLabForm starting with v2 will look for config_version key in the config file. If it doesn't exist, or the version does not match expected then the app will exit to avoid applying unexpected configuration and allowing the user to update the configuration. (RC1) New config syntax (breaking change). All 3 levels under a common key projects_and_groups . It should contain a dict, where common config is under a special \"*\" key, group configs under keys like group/* and project configs under keys like group/project . This will allow introducing pattern matching in these keys and introducing support for multiple config files in the future releases. Partially implements #138 . (RC1) Exit with code != 0 when any group/project processing was failed (breaking change). This will allow you to notice problems when running the app from CI. Note that you can restore the old behaviour by running the app with (...) || true . Also standardized exit codes. Exit with 1 in case of input error (f.e. config file does not exist), with 2 in case of processing error (f.e. GitLab returns HTTP 500).Fixes #153 . (RC1) Allow any case in groups and projects names (breaking change). GitLab groups and projects names are case sensitive but you cannot create such entities that differ only in the case. There is also a distinction between a \"name\" and a \"path\" and they may differ in case... To make work with this easier GitLabForm now accepts any case for them in both config files as well as when provided as command line arguments. We also disallow such entities that differ only in case (f.e. group/* and GROUP/* ) to avoid ambiguity. Fixes #160 . (RC2) Ignore archived projects by default (breaking change). This makes processing faster and output shorter. You can restore the previous behavior by adding --include-archived-projects / -a command line switch. Note that you have to do it if you want to unarchive archived projects! Fixes #157 in (arguably) a more convenient way. (RC2) Color output! Implements #141 . (RC1) Add diffing feature for secret variables. (with values shown as hashes to protect the secrets from leaking). (RC6) Added checking for invalid syntax in \"members\" section. Defining groups or users directly under this key instead of under sub-keys \"users\" and \"groups\" will now trigger an immediate error. (RC5) Add support for Python 3.9 (RC8) Added Windows support. Fixes #206 (RC5) Start processing at any group using the new command line switch - --start-from-group / -sfg . Similar to --start-from / -sf switch that can be used for projects. (RC1) Start releasing pre-releases as Docker images. They have tags with specific versions, but not \"latest\" tag as it is reserved for new final releases. Implements #201 (RC5) Prevent multiple email notifications from being sent when adding members to project. Fixes #101 (RC6) Prevent project's Audit Events being filled in with \"Added protected branch\". Fixes #178 (RC6) Fixed using \"expires_at\" for users. Fixes #207 (RC6) Remove the need to add the gitlab.api_version configuration key. (RC1) For Contributors Make writing tests easier and the tests more robust. Deduplicate a lot of the boilerplate code, allow putting configs into the test methods and use pytest fixtures for easier setup and cleanup. This should fix issues with tests reported in #190 . Also stop storing any dockerized GitLab data permanently to avoid problems like #196 and probably other related to failed dockerized GitLab upgrades. (RC3) For Contributors Rename \"integration tests\" to \"acceptance tests\". Because they ARE in fact acceptance tests. (RC3) Thanks to @amimas , @weakcamel , @kowpatryk , @ss7548 , @houres , @Pigueiras and @YuraBeznos for their contributions!","title":"2.0.0"},{"location":"changelog/#before-200","text":"Please see GitHub pre-2.0 releases' descriptions .","title":"before 2.0.0"},{"location":"features/","text":"Features \u00b6 GitLabForm enables you to manage: Group: Badges , Members (users) {add/remove user, change access level, optional enforce} , Members (groups) {share/unshare with group, change access level, optional enforce} , Members using LDAP Group Links ( GitLab Premium (paid) only ), CI/CD variables , Settings , Project: Archive/unarchive , Badges CI/CD variables , Protected branches : access levels (roles) allowed to push/merge/unprotect, allow force push flag, users/groups allowed to push/merge/unprotect, code owner approval required flag ( GitLab Premium (paid) only ), Protected environments , Deploy keys , Files {add, edit or delete}, with templating based on Jinja2 (now supports custom variables!) , Webhooks , Members (users) {add/remove user, change access level, optional enforce} , Members (groups) {share/unshare with group, change access level, optional enforce} , Merge Requests approvals settings and approvers ( GitLab Premium (paid) only ), Pipeline schedules , Push Rules ( GitLab Premium (paid) only ), Integrations , Settings , Tags protect/unprotect , Resource groups , ...for: all projects in your GitLab instance/that you have access to, a group/subgroup of projects, a single project, ...and a combination of them.","title":"\u2728 Features"},{"location":"features/#features","text":"GitLabForm enables you to manage: Group: Badges , Members (users) {add/remove user, change access level, optional enforce} , Members (groups) {share/unshare with group, change access level, optional enforce} , Members using LDAP Group Links ( GitLab Premium (paid) only ), CI/CD variables , Settings , Project: Archive/unarchive , Badges CI/CD variables , Protected branches : access levels (roles) allowed to push/merge/unprotect, allow force push flag, users/groups allowed to push/merge/unprotect, code owner approval required flag ( GitLab Premium (paid) only ), Protected environments , Deploy keys , Files {add, edit or delete}, with templating based on Jinja2 (now supports custom variables!) , Webhooks , Members (users) {add/remove user, change access level, optional enforce} , Members (groups) {share/unshare with group, change access level, optional enforce} , Merge Requests approvals settings and approvers ( GitLab Premium (paid) only ), Pipeline schedules , Push Rules ( GitLab Premium (paid) only ), Integrations , Settings , Tags protect/unprotect , Resource groups , ...for: all projects in your GitLab instance/that you have access to, a group/subgroup of projects, a single project, ...and a combination of them.","title":"Features"},{"location":"installation/","text":"Installation \u00b6 Run without installing \u00b6 Note: you don't have to install the app to use it. You can just run the latest stable version with: Docker: docker run -it -v $( pwd ) :/config ghcr.io/gitlabform/gitlabform:latest gitlabform pipx : pipx run gitlabform Similarly, you can run the latest 3.* version with: Docker: docker run -it -v $( pwd ) :/config ghcr.io/gitlabform/gitlabform:3 gitlabform pipx : pipx run --spec 'gitlabform>=3,<4' gitlabform See this for all the available Docker tags. Really install \u00b6 If you do want to install the app you can do it with: pipx (recommended): pipx install gitlabform plain pip : pip3 install gitlabform","title":"\ud83d\udcbe Installation"},{"location":"installation/#installation","text":"","title":"Installation"},{"location":"installation/#run-without-installing","text":"Note: you don't have to install the app to use it. You can just run the latest stable version with: Docker: docker run -it -v $( pwd ) :/config ghcr.io/gitlabform/gitlabform:latest gitlabform pipx : pipx run gitlabform Similarly, you can run the latest 3.* version with: Docker: docker run -it -v $( pwd ) :/config ghcr.io/gitlabform/gitlabform:3 gitlabform pipx : pipx run --spec 'gitlabform>=3,<4' gitlabform See this for all the available Docker tags.","title":"Run without installing"},{"location":"installation/#really-install","text":"If you do want to install the app you can do it with: pipx (recommended): pipx install gitlabform plain pip : pip3 install gitlabform","title":"Really install"},{"location":"requirements/","text":"Requirements \u00b6 Docker or Python 3.7-3.11 Self-Hosted GitLab 14.4+ Premium (paid) license for some features","title":"\ud83e\udef4 Requirements"},{"location":"requirements/#requirements","text":"Docker or Python 3.7-3.11 Self-Hosted GitLab 14.4+ Premium (paid) license for some features","title":"Requirements"},{"location":"running/","text":"Running \u00b6 To apply settings for a single project, run the app with the path to the project, f.e.: gitlabform my-group/my-project1 To apply settings for a group of projects, run: gitlabform my-group To apply settings for all groups of projects and projects explicitly defined in the config, run: gitlabform ALL_DEFINED To apply settings for all projects, run: gitlabform ALL Run: gitlabform -h ...to see the current set of supported command line parameters.","title":"\ud83c\udfc3 Running"},{"location":"running/#running","text":"To apply settings for a single project, run the app with the path to the project, f.e.: gitlabform my-group/my-project1 To apply settings for a group of projects, run: gitlabform my-group To apply settings for all groups of projects and projects explicitly defined in the config, run: gitlabform ALL_DEFINED To apply settings for all projects, run: gitlabform ALL Run: gitlabform -h ...to see the current set of supported command line parameters.","title":"Running"},{"location":"similar_apps/","text":"Similar apps \u00b6 GitLab provider for Terraform \u00b6 Terraform , the almost universal \"* as a code\" tool from Hashicorp, which inspired this app (hence the name!), has a provider for configuring GitLab using the Hashicorp Configuration Language (HCL). It is an older and more mature solution than GitLabForm, using a de-facto standard configuration language, but it's also more generic. GitLabForm has been built specifically for managing GitLab and has been designed around different concepts that provide a different set of features, arguably a more powerful one. Key differences \u00b6 ...between GitLab provider for Terraform (\" GT \") and GitLabForm (\" GLF \"): GT allows creating resources such as users, groups and projects while GLF (as of now) allows only configuring existing entities (with an exception for management of files in the repo, which is a unique GLF feature), GT can only manage specific groups and projects. GLF allows configuring everything it supports for ALL of your projects in your GitLab instance (with the possibility to provide more specialized configuration for some of the groups and projects). GT is using a structured language which describes each managed resource explicitly (with iterators, of course) while GLF is based on YAML and a concept of hierarchical, inheritable configuration with merging/overwriting and addivity. Therefore only with GLF you can write configs like \"For all projects in group X do this, but for specific projects X/A and X/B in it also do this and for X/C do something a bit different\". GT wraps the GitLab API into abstractions while GLF in many cases (explained in the docs) makes PUT/POST requests of the dicts found in the config as-is to the GitLab API. GT approach is more convenient and less \"raw\" (you read GT docs when using it, while for GLF you also have to read GitLab API docs) but GLF allows you to use all of the GitLab API features - GT supports only a fraction of GitLab's API parameters for editing group and project while GLF by design allows you to use all of them. Also when you update your GitLab instance you can start using new API features immediately with GLF while with GT you have to wait until its new version supporting those features is released. Feature matrix/comparison sheet \u00b6 For your convenience we have prepared GitLab provider for Terraform vs GitLabForm feature matrix / comparion sheet . Note: this sheet MAY contain errors and WILL get outdated. Please report these issues in it using comments. Thank you! GitLab Configuration as Code (GCasC) \u00b6 To configure your GitLab instance itself (appearance, application settings, features, license) please check out the GitLab Configuration as Code (GCasC) project!","title":"\u2696\ufe0f Similar Apps"},{"location":"similar_apps/#similar-apps","text":"","title":"Similar apps"},{"location":"similar_apps/#gitlab-provider-for-terraform","text":"Terraform , the almost universal \"* as a code\" tool from Hashicorp, which inspired this app (hence the name!), has a provider for configuring GitLab using the Hashicorp Configuration Language (HCL). It is an older and more mature solution than GitLabForm, using a de-facto standard configuration language, but it's also more generic. GitLabForm has been built specifically for managing GitLab and has been designed around different concepts that provide a different set of features, arguably a more powerful one.","title":"GitLab provider for Terraform"},{"location":"similar_apps/#key-differences","text":"...between GitLab provider for Terraform (\" GT \") and GitLabForm (\" GLF \"): GT allows creating resources such as users, groups and projects while GLF (as of now) allows only configuring existing entities (with an exception for management of files in the repo, which is a unique GLF feature), GT can only manage specific groups and projects. GLF allows configuring everything it supports for ALL of your projects in your GitLab instance (with the possibility to provide more specialized configuration for some of the groups and projects). GT is using a structured language which describes each managed resource explicitly (with iterators, of course) while GLF is based on YAML and a concept of hierarchical, inheritable configuration with merging/overwriting and addivity. Therefore only with GLF you can write configs like \"For all projects in group X do this, but for specific projects X/A and X/B in it also do this and for X/C do something a bit different\". GT wraps the GitLab API into abstractions while GLF in many cases (explained in the docs) makes PUT/POST requests of the dicts found in the config as-is to the GitLab API. GT approach is more convenient and less \"raw\" (you read GT docs when using it, while for GLF you also have to read GitLab API docs) but GLF allows you to use all of the GitLab API features - GT supports only a fraction of GitLab's API parameters for editing group and project while GLF by design allows you to use all of them. Also when you update your GitLab instance you can start using new API features immediately with GLF while with GT you have to wait until its new version supporting those features is released.","title":"Key differences"},{"location":"similar_apps/#feature-matrixcomparison-sheet","text":"For your convenience we have prepared GitLab provider for Terraform vs GitLabForm feature matrix / comparion sheet . Note: this sheet MAY contain errors and WILL get outdated. Please report these issues in it using comments. Thank you!","title":"Feature matrix/comparison sheet"},{"location":"similar_apps/#gitlab-configuration-as-code-gcasc","text":"To configure your GitLab instance itself (appearance, application settings, features, license) please check out the GitLab Configuration as Code (GCasC) project!","title":"GitLab Configuration as Code (GCasC)"},{"location":"upgrade/","text":"Upgrading to new major versions \u00b6 Some of these changes between major application versions may affect the effective configuration that would be applied if you run the application. Therefore to do the upgrade safely please follow this procedure. From 2.* to 3.* \u00b6 Steps outline: Update to the latest v2.x.x and fix all the deprecation warnings the application prints out during run . The syntax deprecated in v2 has been removed in v3. Stop v2 from running automatically (if you have such automation). In your config: In v3 a bug that caused subgroup config to not inherit its group config has been fixed. If you do have configs for some groups and a config for their subgroups, then your effective configuration may change after the upgrade to v3. If you do not want that, or you are not sure, then please do the following to keep the old behavior: add inherit: false entries to all of such subgroups config, under each configuration section: Example: projects_and_groups : some_group/* : group_settings : project_creation_level : maintainer subgroup_creation_level : owner visibility : internal some_group/subgroup/* : group_settings : # add the line below to keep the old behavior inherit : false project_creation_level : developer some_group/subgroup/subsubgroup/* : group_settings : # add the line below to keep the old behavior inherit : false visibility : private Replace services: with integrations: , Replace secret_variables: with variables: , Replace group_secret_variables: with group_variables: , Replace config_version: 2 with config_version: 3 Upgrade the app from v2 to v3. Re-enable v3 to run automatically (if you have such automation). From 1.* to 2.* \u00b6 Steps outline: Generate effective configuration that is applied when you run v1 and keep it. Update to >= v1.23.0 first, as we added the feature to output the effective config to file to that version. Add these parameters to your regular ones: --output-file v1_configuration.yaml . You may also add -n to run it in a noop mode. Save the generated YAML. Stop v1 from running automatically (if you have such automation). Upgrade to v2 and update the configuration syntax. The major syntax changes are: add config_version: 2 , remove api_version: 4 , common, group and project configs are now all under a single projects_and_groups key, if you have common_settings section then move it under a new key \"*\" under projects_and_groups , if you have groups_settings or projects_settings then move their contents to be under all under projects_and_groups , for each group config replace <group name>: with <group name>/*: . leave project configs unchanged. Generate effective configuration that is applied when you run v2 using \"noop\" mode. Add these parameters to your regular ones: --output-file v2_configuration.yaml --noop --include-archived-projects . (The last one is needed to have the projects list to process the same as for v1, as v2 by default skips the archived projects.) Save the generated YAML file. Compare the YAML files with effective configuration from v1 to v2 and correct the configuration to get either exactly the same result or acceptable differences. Run v2 without the \"noop\" mode and review the results. Look for failures and exit code different from 0. Fix found issues. Re-enable v2 to run automatically (if you have such automation).","title":"\u23eb Upgrading"},{"location":"upgrade/#upgrading-to-new-major-versions","text":"Some of these changes between major application versions may affect the effective configuration that would be applied if you run the application. Therefore to do the upgrade safely please follow this procedure.","title":"Upgrading to new major versions"},{"location":"upgrade/#from-2-to-3","text":"Steps outline: Update to the latest v2.x.x and fix all the deprecation warnings the application prints out during run . The syntax deprecated in v2 has been removed in v3. Stop v2 from running automatically (if you have such automation). In your config: In v3 a bug that caused subgroup config to not inherit its group config has been fixed. If you do have configs for some groups and a config for their subgroups, then your effective configuration may change after the upgrade to v3. If you do not want that, or you are not sure, then please do the following to keep the old behavior: add inherit: false entries to all of such subgroups config, under each configuration section: Example: projects_and_groups : some_group/* : group_settings : project_creation_level : maintainer subgroup_creation_level : owner visibility : internal some_group/subgroup/* : group_settings : # add the line below to keep the old behavior inherit : false project_creation_level : developer some_group/subgroup/subsubgroup/* : group_settings : # add the line below to keep the old behavior inherit : false visibility : private Replace services: with integrations: , Replace secret_variables: with variables: , Replace group_secret_variables: with group_variables: , Replace config_version: 2 with config_version: 3 Upgrade the app from v2 to v3. Re-enable v3 to run automatically (if you have such automation).","title":"From 2.* to 3.*"},{"location":"upgrade/#from-1-to-2","text":"Steps outline: Generate effective configuration that is applied when you run v1 and keep it. Update to >= v1.23.0 first, as we added the feature to output the effective config to file to that version. Add these parameters to your regular ones: --output-file v1_configuration.yaml . You may also add -n to run it in a noop mode. Save the generated YAML. Stop v1 from running automatically (if you have such automation). Upgrade to v2 and update the configuration syntax. The major syntax changes are: add config_version: 2 , remove api_version: 4 , common, group and project configs are now all under a single projects_and_groups key, if you have common_settings section then move it under a new key \"*\" under projects_and_groups , if you have groups_settings or projects_settings then move their contents to be under all under projects_and_groups , for each group config replace <group name>: with <group name>/*: . leave project configs unchanged. Generate effective configuration that is applied when you run v2 using \"noop\" mode. Add these parameters to your regular ones: --output-file v2_configuration.yaml --noop --include-archived-projects . (The last one is needed to have the projects list to process the same as for v1, as v2 by default skips the archived projects.) Save the generated YAML file. Compare the YAML files with effective configuration from v1 to v2 and correct the configuration to get either exactly the same result or acceptable differences. Run v2 without the \"noop\" mode and review the results. Look for failures and exit code different from 0. Fix found issues. Re-enable v2 to run automatically (if you have such automation).","title":"From 1.* to 2.*"},{"location":"contrib/","text":"Contributing \u00b6 All contributions are welcome! ask questions, report issues, ask for features or write anything message to the app authors - use Issues for all of these, contribute to the documentation and example configuration - with Pull Requests , contribute your bug fixes, new features, refactoring and other code improvements - with Pull Requests , ...and probably more! If you want to help in any way but don't know how - create an Issue . Issues \u00b6 As the project is not (yet ;) flooded with issues the guidelines for creating them are not very strict and should be very common sense ones. Questions \u00b6 Before asking a question please make sure that you have read these docs. Problems \u00b6 Before reporting a problem please update GitLabForm to the latest version and check if the issue persists. If it does then please try to report what environment you have, what you try to do, what you expect to happen and what does in fact happen. To be more specific please remember to: provide GitLab version, provide GitLabForm version, provide your Python version and Operating System, provide config in whole, or a relevant fragment (of course you can and should redact any values you need to redact for privacy and security reasons), Feature requests \u00b6 Please note that although we do accept feature requests we do not promise to fulfill them. However, it's still worth creating an issue for this as it shows interest in given feature and that may be taken into account by both existing app authors and new contributors when planning to implement something new. Pull Requests \u00b6 Please read the other articles about contributing for more info about this.","title":"Contributing"},{"location":"contrib/#contributing","text":"All contributions are welcome! ask questions, report issues, ask for features or write anything message to the app authors - use Issues for all of these, contribute to the documentation and example configuration - with Pull Requests , contribute your bug fixes, new features, refactoring and other code improvements - with Pull Requests , ...and probably more! If you want to help in any way but don't know how - create an Issue .","title":"Contributing"},{"location":"contrib/#issues","text":"As the project is not (yet ;) flooded with issues the guidelines for creating them are not very strict and should be very common sense ones.","title":"Issues"},{"location":"contrib/#questions","text":"Before asking a question please make sure that you have read these docs.","title":"Questions"},{"location":"contrib/#problems","text":"Before reporting a problem please update GitLabForm to the latest version and check if the issue persists. If it does then please try to report what environment you have, what you try to do, what you expect to happen and what does in fact happen. To be more specific please remember to: provide GitLab version, provide GitLabForm version, provide your Python version and Operating System, provide config in whole, or a relevant fragment (of course you can and should redact any values you need to redact for privacy and security reasons),","title":"Problems"},{"location":"contrib/#feature-requests","text":"Please note that although we do accept feature requests we do not promise to fulfill them. However, it's still worth creating an issue for this as it shows interest in given feature and that may be taken into account by both existing app authors and new contributors when planning to implement something new.","title":"Feature requests"},{"location":"contrib/#pull-requests","text":"Please read the other articles about contributing for more info about this.","title":"Pull Requests"},{"location":"contrib/coding_guidelines/","text":"Coding guidelines \u00b6 Please do: use the common sense, add tests along with the new code that prove that it works: when adding/changing non-trivial logic please add unit tests, for all bug fixes and new features using GitLab API please add acceptance tests use Black code formatter: black . We recommend and provide a config for pre-commit to generate a pre-commit hook that will automatically reformat your contributions with Black. squash your commits (unless there is a reason not to), try to write good commit message(s) , ...and so on. Additionally, please follow these GitLabForm-specific guidelines: do not uptick version file in your PR - you will quickly have to resolve conflicts if you do that as we release more often than the usual baking time of a PR... We are open to refactoring but in case of bigger efforts we suggest creating an issue first and discussing what you propose to do before doing it.","title":"Coding Guidelines"},{"location":"contrib/coding_guidelines/#coding-guidelines","text":"Please do: use the common sense, add tests along with the new code that prove that it works: when adding/changing non-trivial logic please add unit tests, for all bug fixes and new features using GitLab API please add acceptance tests use Black code formatter: black . We recommend and provide a config for pre-commit to generate a pre-commit hook that will automatically reformat your contributions with Black. squash your commits (unless there is a reason not to), try to write good commit message(s) , ...and so on. Additionally, please follow these GitLabForm-specific guidelines: do not uptick version file in your PR - you will quickly have to resolve conflicts if you do that as we release more often than the usual baking time of a PR... We are open to refactoring but in case of bigger efforts we suggest creating an issue first and discussing what you propose to do before doing it.","title":"Coding guidelines"},{"location":"contrib/implementation_design/","text":"Implementation design \u00b6 If you haven't done this before, please read the configuration introduction article first. It explains the \" why \"s of the two key design concepts of this app: hierarchical configuration with inheritance, merging/overwriting and additivity, raw parameters passing Please also read the general coding guidelines for the basics of how to create PRs, the expected style of your code etc. - the \" general how \"s. This article purpose is to explain \" specific how \"s - explain what is where in the code and how to add features by example. Project Structure \u00b6 Packages overview \u00b6 gitlabform.* , gitlabform.lists.* and gitlabform.processors.* - these contain the main app logic. They provide the CLI, parsing of the parameters ( gitlabform.* ), getting the input lists of groups and projects to process and omitting unneeded ones to get the effective lists ( gitlabform.lists.* ) and finally processors are used to apply the groups and projects configurations in GitLab, gitlabform.gitlab.* - contains the GitLab API client code, grouped mostly by the GitLab API as documented at docs.gitlab.com . gitlabform.configuration.* - contains the logic for reading the config from YAML file or a string (the latter is only for testing) and getting an effective config per GitLab project by merging the config on these levels: common, group and project settings. Please see the below doc sections for more info about these packages. Common pattern - multiple inheritance \u00b6 In many of the above packages we are using multiple inheritance . The basic features are often implemented in the \"core\" class defined in core.py . Extensions to it are defined in all other files as \"feature\" classes that inherit the \"core\". Finally, there is an \"everything\" class that groups them all - it is defined in the __init__.py file. gitlabform. , gitlabform.lists. and gitlabform.processors.* \u00b6 The entry point for running the app is in run.py and the main logic is in the GitLabForm class. This code boils down to the run() method, which for each project that according to the app parameters and config should be taken into account, applies the effective config. The code in gitlabform.lists.* is used to generate the input lists of groups and projects, omit the ones that can and should be omitted for saving the processing time (f.e. archived projects, groups and projects with empty effective config) and this way generate the effective lists of groups and projects. The effective config for these contain what is called the \"config sections\", which are the YAML keys that can exist under projects in the config YAML, for example: deploy_keys , variables , group_variables and so on. Those config sections are processed by the code in the classes inheriting from the AbstractProcessor class. This class should be reused when implementing new functionalities (such as supporting new configuration keys) as it holds the common logic for skipping the configuration parts and running in dry-run mode. The processors have been grouped into two packages - group where the processors applied to the group settings are implemented and project - where processors executed on the project level are located. Since v2.2.0 there is a new way of implementing processors - by inheriting form MultipleEntitiesProcessor class. It should be applied for new features which manage 0-N entities of some kind under a group or a project. See BadgesProcessor as an example how to use it. Since v2.10.0 we have a similar solution for features where you manage a single entity - SingleEntityProcessor class. See ProjectPushRulesProcessor as an example how to use it. Usage \u00b6 If you want to add/change/fix things under an existing config section then most likely you will need to update the code in the processor classes (for example, in BranchesProcessor ). If you want to add support for a new config section (= completely new feature), then you need to: (TODO: expand this sections) Consider writing a new processor using MultipleEntitiesProcessor or SingleEntityProcessor class as a base. Create a new class group_<new_config_section_name>_processor (if it applies to the group settings) or <new_config_section_name>_processor (if it applies to project settings) and implement two methods: _process_configuration - which does the actual processing by calling the API and applying the changes in GitLab; _log_changes - which is optional but recommended to implement; by calling this method the effective changes to be applied should be logged (when running in dry-run mode). Add the new processor to GroupProcessors in group > __init__.py (if group settings processor was created) or to ProjectProcessors in project > __init__.py . gitlabform.gitlab.* \u00b6 With the basics for making requests to the GitLab API covered in the GitLabCore class in core.py , all other code is simple (most of the time). Almost all methods in other classes end up calling self._make_requests_to_api , which takes care of making the HTTP GitLab API requests with proper authentication, pagination, retries, timeouts and more. Sometimes there is some logic in these methods if: we only need a specific part of the response from GitLab API - see GitLabProjects.get_all_projects() as an example, some GitLab APIs need some workarounds for their bugs or documentation inconsistencies, like: some APIs declare in the docs that they accept both \"group/project\" string OR a project id while in fact only the latter works - see GitLabProjects.post_approvals() as an example, some APIs return invalid HTTP error codes, like 404 instead of 400 - see GitLabGroupLDAPLinks.add_ldap_group_link as an example. Note : Some of the code here is NOT used by the GitLabForm app , but utilized by internal Egnyte applications that have not (yet) switched to the more standard python-gitlab . Usage \u00b6 If you want to add/change/fix code that operates on an existing GitLab API you should look around the \"feature\" classes in this package (for example GitLabMergeRequests in merge_requests.py ). If you want to add code that operates on the new GitLab API you should: create a new new_gitlab_api_name.py file in gitlabform.gitlab and define a \"feature\" class there that inherits GitLabCore (for example: GitLabApiName ). add the new feature class to the list of classes inherited by the \"everything\" GitLab class defined in __init__.py . gitlabform.configuration.* \u00b6 The core code in this package contains some share code, which apart from the rather obvious things like parsing the input YAML, getting the value from a specific subkey and merging configs, contains also: code for breaking configuration inheritance using inherit: false , dealing with groups and project names in GitLab being de facto case-insensitive (you can change case of such entities name, but you cannot have 2 which names differ only in case) (see \"almost duplicates\" in the code), The class inheritance order in this package (core -> common -> groups -> projects) is intentional, as common config affects groups configs and this in turn affects projects configs. The effective configuration for a project may contain elements that are inherited from the common level and from the group level. A separate module in this package, transform.py , contains code that does YAML-level transformation form allow a more user-friendly config syntax that is later replaced with a syntax required by GitLab API. An example of this can be accepting user: <username> in the input config syntax but internally transforming it into user_id: <id_number> .","title":"Implementation Design"},{"location":"contrib/implementation_design/#implementation-design","text":"If you haven't done this before, please read the configuration introduction article first. It explains the \" why \"s of the two key design concepts of this app: hierarchical configuration with inheritance, merging/overwriting and additivity, raw parameters passing Please also read the general coding guidelines for the basics of how to create PRs, the expected style of your code etc. - the \" general how \"s. This article purpose is to explain \" specific how \"s - explain what is where in the code and how to add features by example.","title":"Implementation design"},{"location":"contrib/implementation_design/#project-structure","text":"","title":"Project Structure"},{"location":"contrib/implementation_design/#packages-overview","text":"gitlabform.* , gitlabform.lists.* and gitlabform.processors.* - these contain the main app logic. They provide the CLI, parsing of the parameters ( gitlabform.* ), getting the input lists of groups and projects to process and omitting unneeded ones to get the effective lists ( gitlabform.lists.* ) and finally processors are used to apply the groups and projects configurations in GitLab, gitlabform.gitlab.* - contains the GitLab API client code, grouped mostly by the GitLab API as documented at docs.gitlab.com . gitlabform.configuration.* - contains the logic for reading the config from YAML file or a string (the latter is only for testing) and getting an effective config per GitLab project by merging the config on these levels: common, group and project settings. Please see the below doc sections for more info about these packages.","title":"Packages overview"},{"location":"contrib/implementation_design/#common-pattern-multiple-inheritance","text":"In many of the above packages we are using multiple inheritance . The basic features are often implemented in the \"core\" class defined in core.py . Extensions to it are defined in all other files as \"feature\" classes that inherit the \"core\". Finally, there is an \"everything\" class that groups them all - it is defined in the __init__.py file.","title":"Common pattern - multiple inheritance"},{"location":"contrib/implementation_design/#gitlabform-gitlabformlists-and-gitlabformprocessors","text":"The entry point for running the app is in run.py and the main logic is in the GitLabForm class. This code boils down to the run() method, which for each project that according to the app parameters and config should be taken into account, applies the effective config. The code in gitlabform.lists.* is used to generate the input lists of groups and projects, omit the ones that can and should be omitted for saving the processing time (f.e. archived projects, groups and projects with empty effective config) and this way generate the effective lists of groups and projects. The effective config for these contain what is called the \"config sections\", which are the YAML keys that can exist under projects in the config YAML, for example: deploy_keys , variables , group_variables and so on. Those config sections are processed by the code in the classes inheriting from the AbstractProcessor class. This class should be reused when implementing new functionalities (such as supporting new configuration keys) as it holds the common logic for skipping the configuration parts and running in dry-run mode. The processors have been grouped into two packages - group where the processors applied to the group settings are implemented and project - where processors executed on the project level are located. Since v2.2.0 there is a new way of implementing processors - by inheriting form MultipleEntitiesProcessor class. It should be applied for new features which manage 0-N entities of some kind under a group or a project. See BadgesProcessor as an example how to use it. Since v2.10.0 we have a similar solution for features where you manage a single entity - SingleEntityProcessor class. See ProjectPushRulesProcessor as an example how to use it.","title":"gitlabform., gitlabform.lists. and gitlabform.processors.*"},{"location":"contrib/implementation_design/#usage","text":"If you want to add/change/fix things under an existing config section then most likely you will need to update the code in the processor classes (for example, in BranchesProcessor ). If you want to add support for a new config section (= completely new feature), then you need to: (TODO: expand this sections) Consider writing a new processor using MultipleEntitiesProcessor or SingleEntityProcessor class as a base. Create a new class group_<new_config_section_name>_processor (if it applies to the group settings) or <new_config_section_name>_processor (if it applies to project settings) and implement two methods: _process_configuration - which does the actual processing by calling the API and applying the changes in GitLab; _log_changes - which is optional but recommended to implement; by calling this method the effective changes to be applied should be logged (when running in dry-run mode). Add the new processor to GroupProcessors in group > __init__.py (if group settings processor was created) or to ProjectProcessors in project > __init__.py .","title":"Usage"},{"location":"contrib/implementation_design/#gitlabformgitlab","text":"With the basics for making requests to the GitLab API covered in the GitLabCore class in core.py , all other code is simple (most of the time). Almost all methods in other classes end up calling self._make_requests_to_api , which takes care of making the HTTP GitLab API requests with proper authentication, pagination, retries, timeouts and more. Sometimes there is some logic in these methods if: we only need a specific part of the response from GitLab API - see GitLabProjects.get_all_projects() as an example, some GitLab APIs need some workarounds for their bugs or documentation inconsistencies, like: some APIs declare in the docs that they accept both \"group/project\" string OR a project id while in fact only the latter works - see GitLabProjects.post_approvals() as an example, some APIs return invalid HTTP error codes, like 404 instead of 400 - see GitLabGroupLDAPLinks.add_ldap_group_link as an example. Note : Some of the code here is NOT used by the GitLabForm app , but utilized by internal Egnyte applications that have not (yet) switched to the more standard python-gitlab .","title":"gitlabform.gitlab.*"},{"location":"contrib/implementation_design/#usage_1","text":"If you want to add/change/fix code that operates on an existing GitLab API you should look around the \"feature\" classes in this package (for example GitLabMergeRequests in merge_requests.py ). If you want to add code that operates on the new GitLab API you should: create a new new_gitlab_api_name.py file in gitlabform.gitlab and define a \"feature\" class there that inherits GitLabCore (for example: GitLabApiName ). add the new feature class to the list of classes inherited by the \"everything\" GitLab class defined in __init__.py .","title":"Usage"},{"location":"contrib/implementation_design/#gitlabformconfiguration","text":"The core code in this package contains some share code, which apart from the rather obvious things like parsing the input YAML, getting the value from a specific subkey and merging configs, contains also: code for breaking configuration inheritance using inherit: false , dealing with groups and project names in GitLab being de facto case-insensitive (you can change case of such entities name, but you cannot have 2 which names differ only in case) (see \"almost duplicates\" in the code), The class inheritance order in this package (core -> common -> groups -> projects) is intentional, as common config affects groups configs and this in turn affects projects configs. The effective configuration for a project may contain elements that are inherited from the common level and from the group level. A separate module in this package, transform.py , contains code that does YAML-level transformation form allow a more user-friendly config syntax that is later replaced with a syntax required by GitLab API. An example of this can be accepting user: <username> in the input config syntax but internally transforming it into user_id: <id_number> .","title":"gitlabform.configuration.*"},{"location":"contrib/local_development/","text":"Local Development \u00b6 Environment setup \u00b6 Create virtualenv with Python 3, for example in venv dir which is in .gitignore and activate it: virtualenv -p python3 venv . venv/bin/activate Install GitLabForm in develop mode: python setup.py develop Now you can run and debug the app locally. Running unit tests \u00b6 GitLabForm uses py.test for tests. You can run unit tests directly on your machine or in a Docker container. Running unit tests locally \u00b6 To run unit tests locally: Activate the virtualenv created above Install the dependencies for tests: pip install -e .[test] Run pytest tests/unit to run all the unit tests. Running unit tests in a Docker container \u00b6 If you have a problem with installing the test dependencies on your localhost, you can run the tests in Docker container too, like this: Build the image: docker build . -f ./dev/tests.Dockerfile -t gitlabform-tests:latest Use it to run the tests: docker run -it -v $(pwd):/code gitlabform-tests:latest /bin/ash -c \"cd /code && pytest tests/acceptance\" Running acceptance tests \u00b6 Most GitLabForm test are the ones that make real operations on a running GitLab instance. You can run them against a disposable GitLab instance running as a Docker container OR use your own GitLab instance. Running acceptance tests using GitLab instance in Docker \u00b6 (optional) If you have it, put your GitLab license in its base64-encoded form into the $GITLAB_EE_LICENSE environment variable or into a git-ignored gitlab-license.json file in the root of the repo with the following content: {\"license\":\"<base64-encoded license file>\"} . According to the license agreement (as of now and IANAL) you are allowed to use it for testing and development purposes such as this. This will make the following script use it to be able to test Premium (paid) features. Of course this license will not leave your machine. Run below commands to start GitLab in a container. Note that it may take a few minutes! ./dev/run_gitlab_in_docker.sh Run pytest tests/acceptance to start all tests. To run only a single class with tests run f.e. py.test tests/acceptance -k \"TestArchiveProject\" . pytest tests/acceptance/<TEST_FILE>.py::<TestClass>::<TEST_METHOD> Running acceptance tests using your own GitLab instance \u00b6 Note : GitLabForm acceptance tests operate own their own groups, projects and users and it should be safe to run them on any GitLab instance. However we do not take any responsibility for it. Please review the code to ensure what it does and run it at your own risk! Get an admin user API token and put it into GITLAB_TOKEN env variable. Do the same with your GitLab instance URL and GITLAB_URL : export GITLAB_URL=\"https://mygitlab.company.com\" export GITLAB_TOKEN=\"<my admin user API token>\" Run pytest tests/acceptance to start all tests To run only a single class with tests run f.e. py.test tests/acceptance -k \"TestArchiveProject\" . Preview docs website locally \u00b6 To make mkdocs build the app website and serve it on your loopback interface do this: . venv/bin/activate pip install -e . [ docs ] mkdocs serve ...and open the provided link (probably http://127.0.0.1:8000/ ) in your browser. Testing types \u00b6 Please run mypy to test static types: mypy . || true mypy --install-types --non-interactive mypy .","title":"Local Development"},{"location":"contrib/local_development/#local-development","text":"","title":"Local Development"},{"location":"contrib/local_development/#environment-setup","text":"Create virtualenv with Python 3, for example in venv dir which is in .gitignore and activate it: virtualenv -p python3 venv . venv/bin/activate Install GitLabForm in develop mode: python setup.py develop Now you can run and debug the app locally.","title":"Environment setup"},{"location":"contrib/local_development/#running-unit-tests","text":"GitLabForm uses py.test for tests. You can run unit tests directly on your machine or in a Docker container.","title":"Running unit tests"},{"location":"contrib/local_development/#running-unit-tests-locally","text":"To run unit tests locally: Activate the virtualenv created above Install the dependencies for tests: pip install -e .[test] Run pytest tests/unit to run all the unit tests.","title":"Running unit tests locally"},{"location":"contrib/local_development/#running-unit-tests-in-a-docker-container","text":"If you have a problem with installing the test dependencies on your localhost, you can run the tests in Docker container too, like this: Build the image: docker build . -f ./dev/tests.Dockerfile -t gitlabform-tests:latest Use it to run the tests: docker run -it -v $(pwd):/code gitlabform-tests:latest /bin/ash -c \"cd /code && pytest tests/acceptance\"","title":"Running unit tests in a Docker container"},{"location":"contrib/local_development/#running-acceptance-tests","text":"Most GitLabForm test are the ones that make real operations on a running GitLab instance. You can run them against a disposable GitLab instance running as a Docker container OR use your own GitLab instance.","title":"Running acceptance tests"},{"location":"contrib/local_development/#running-acceptance-tests-using-gitlab-instance-in-docker","text":"(optional) If you have it, put your GitLab license in its base64-encoded form into the $GITLAB_EE_LICENSE environment variable or into a git-ignored gitlab-license.json file in the root of the repo with the following content: {\"license\":\"<base64-encoded license file>\"} . According to the license agreement (as of now and IANAL) you are allowed to use it for testing and development purposes such as this. This will make the following script use it to be able to test Premium (paid) features. Of course this license will not leave your machine. Run below commands to start GitLab in a container. Note that it may take a few minutes! ./dev/run_gitlab_in_docker.sh Run pytest tests/acceptance to start all tests. To run only a single class with tests run f.e. py.test tests/acceptance -k \"TestArchiveProject\" . pytest tests/acceptance/<TEST_FILE>.py::<TestClass>::<TEST_METHOD>","title":"Running acceptance tests using GitLab instance in Docker"},{"location":"contrib/local_development/#running-acceptance-tests-using-your-own-gitlab-instance","text":"Note : GitLabForm acceptance tests operate own their own groups, projects and users and it should be safe to run them on any GitLab instance. However we do not take any responsibility for it. Please review the code to ensure what it does and run it at your own risk! Get an admin user API token and put it into GITLAB_TOKEN env variable. Do the same with your GitLab instance URL and GITLAB_URL : export GITLAB_URL=\"https://mygitlab.company.com\" export GITLAB_TOKEN=\"<my admin user API token>\" Run pytest tests/acceptance to start all tests To run only a single class with tests run f.e. py.test tests/acceptance -k \"TestArchiveProject\" .","title":"Running acceptance tests using your own GitLab instance"},{"location":"contrib/local_development/#preview-docs-website-locally","text":"To make mkdocs build the app website and serve it on your loopback interface do this: . venv/bin/activate pip install -e . [ docs ] mkdocs serve ...and open the provided link (probably http://127.0.0.1:8000/ ) in your browser.","title":"Preview docs website locally"},{"location":"contrib/local_development/#testing-types","text":"Please run mypy to test static types: mypy . || true mypy --install-types --non-interactive mypy .","title":"Testing types"},{"location":"contrib/releases/","text":"Releases \u00b6 Versioning \u00b6 We try to follow the PEP 440 versioning scheme, which is mostly based on semantic versioning . Procedure \u00b6 Add an entry in CHANGELOG.md . Remember to give thanks to all the contributors! Use tbump to bump the version. Edit the release in GitHub. Copy the changelog entry into its description","title":"Releases"},{"location":"contrib/releases/#releases","text":"","title":"Releases"},{"location":"contrib/releases/#versioning","text":"We try to follow the PEP 440 versioning scheme, which is mostly based on semantic versioning .","title":"Versioning"},{"location":"contrib/releases/#procedure","text":"Add an entry in CHANGELOG.md . Remember to give thanks to all the contributors! Use tbump to bump the version. Edit the release in GitHub. Copy the changelog entry into its description","title":"Procedure"},{"location":"reference/","text":"Configuration reference \u00b6 The whole configuration for the app needs to be in a single YAML file of any name. The default location used is the current working directory and the default name is config.yml . Minimal working config \u00b6 Here is an example of a complete small config that actually does something: config_version : 3 gitlab : url : https://gitlab.yourcompany.com # alternatively use the GITLAB_TOKEN environment variable token : \"<private token of an admin user>\" projects_and_groups : \"*\" : project_settings : visibility : internal Mandatory top-level keys \u00b6 The configuration has to contain the following top-level keys: # This key is required in configs for GitLabForm version 3.x.x # This ensures that if the application behavior changes in a backward-incompatible way # you won't apply unwanted configuration to your GitLab instance. config_version : 3 # GitLab API access config gitlab : # alternatively use the GITLAB_URL environment variable for this url : https://gitlab.yourcompany.com # alternatively use the GITLAB_TOKEN environment variable for this token : \"<private token OR an OAuth2 access token of an admin user>\" # ** optional parameters - below values are defaults ** # whether the SSL certificate of your GitLab instance should be verified, # set this to `false` if you are using a self-signed certificate (not recommended) ssl_verify : true # timeout for the whole requests to the GitLab API, in seconds timeout : 10 # Configuration to apply to GitLab projects, groups and subgroups projects_and_groups : # (...) # See below. Projects and groups configuration \u00b6 Configuration hierarchy \u00b6 In GitLabForm you define the configuration for your groups and projects under the projects_and_groups: top-level key, on 3 levels: Level name Key syntax Description common \"*\" the configuration that will be applied to all projects and all groups group/subgroup group/* , group/subgroup/* the configuration that will be applied to everything under a given group/subgroup, recursively (so the group/subgroup itself, all the projects in it, all the subgroups in it and all the projects in the subgroups in it) project group/project , group/subgroup/project the configuration for specific single projects Each level is optional. Order does not matter. Example: # (...) - other mandatory top-level keys projects_and_groups : \"*\" : # common-level config group_1/* : # group-level config group_1/project_1 : # project-level config group_1/project_2 : # project-level config group_1/project_3 : # project-level config group_2/* : # group-level config group_2/project_1 : # project-level config group_2/subgroup/* : # subgroup-level config group_2/subgroup/nested_project_1 : # project-level config Configuration sections \u00b6 Under each of the keys described above, we put configuration to apply for given entities. These keys are called \"sections\" within this app. Some configuration sections apply only to projects , some to groups . Syntax for each section is explained in detail on subpages - see links on the left. Effective configuration \u00b6 To generate the effective configuration to apply for a given project or group, if it is configured on more than one level, GitLabForm will merge those configurations. If there are conflicting values in the more general (f.e. common) and more specific level (f.e. group level), then the more specific configuration will overwrite the more general one. Example: projects_and_groups : # common settings for ALL projects in ALL groups \"*\" : project_settings : default_branch : main visibility : internal group_1/* : project_settings : visibility : private With this configuration, for a project group_1/project_1 the effective configuration will be like: project_settings : default_branch : main visibility : private If the keys are added under different names in the more general and the more specific config, then they are added . So for example for sections like deploy_keys , variables , hooks on each lower level the effective configuration will contain elements from the higher levels AND the elements from the lower levels. Example: projects_and_groups : \"*\" : deploy_keys : a_shared_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDB2QKx6BPzL... title : global_key can_push : false group_1/* : deploy_keys : another_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDtbyEK66RXg... title : group_key can_push : false With this configuration, for a project group_1/project_1 the effective configuration will be: deploy_keys : a_shared_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDB2QKx6BPzL... title : global_key can_push : false another_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDtbyEK66RXg... title : group_key can_push : false Note that if you want to have a key removed , you will need to use the break-inheritance: true feature, explained in details below. For example for the following configuration: projects_and_groups : \"*\" : variables : shared_with_all_projects : &shared_with_all_projects key : SSH_PRIVATE_KEY_BASE64 value : \"LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUl (...)\" shared_with_ALMOST_all_projects : key : PROTECTED_VAR value : \"foobar-123 (...)\" protected : true group_1/project_1 : variables : << : *shared_with_all_projects Note that we used YAML anchors here to not repeat ourselves. With this configuration, for a project group_1/project_1 the effective configuration will be: group_1/project_1 : variables : shared_with_all_projects : key : SSH_PRIVATE_KEY_BASE64 value : \"LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUl (...)\" Warning : dicts are additive but arrays are not! For example with this config: projects_and_groups : \"*\" : merge_requests_approval_rules : default : approvals_required : 2 name : \"Team X or Y or super-user\" groups : - group-x - group-y users : - super-user group_1/* : merge_requests_approval_rules : default : approvals_required : 1 name : \"Team Z\" groups : - group-z users : [] With this configuration, for a project group_1/project_1 the effective configuration will be: merge_requests_approval_rules : default : approvals_required : 1 name : \"Team Z\" groups : - group-z Note that the value of groups is an array, so the effective groups contains only the single element array from group_1/* - the arrays were not added! Also note that the users is a key in the default dict, so we could not omit it. If we did that then adding would work here and users would be effective set to [super-user] . We didn't want that and that's why we did set it an explicitly empty array [] . Breaking inheritance \u00b6 You can prevent inheriting configuration from the higher levels by placing inherit: false under a given section. Example: projects_and_groups : \"*\" : deploy_keys : a_shared_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDB2QKx6BPzL... title : global_key # this name is show in GitLab can_push : false group_1/* : deploy_keys : inherit : false another_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDtbyEK66RXg... title : group_key # this name is show in GitLab can_push : false For the above configuration, for a project group_1/project_1 the effective configuration for section deploy_keys is like defined for all projects and groups under * , with the more specific config in group_1/* ignored. In other words it will be like this: deploy_keys : a_shared_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDB2QKx6BPzL... title : global_key # this name is show in GitLab can_push : false Important inherit: false can be placed at ANY place in the configuration (if it makes sense). Skipping sections \u00b6 If the only key under a section is skip: true then the given config section is not set AT ALL for a given entity. Example: projects_and_groups : \"*\" : deploy_keys : a_shared_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDB2QKx6BPzL... title : global_key can_push : false group_1/* : deploy_keys : skip : true For the above configuration, for a project group_1/project_1 the deploy keys are not managed by GitLabForm all. Important skip: true can be placed ONLY directly under a section name. Raw parameters passing \u00b6 Some configuration sections, f.e. project_settings , will be directly send by the app via the API to specific GitLab API endpoints. This means that they key names and values are exactly like they are described in the appropriate API docs. These sections are appropriately marked in the reference docs. The advantages of this approach: you can use all the parameters from the API - for the project_settings it is over 40 parameters as of now (see the GitLab API for Projects ) while for group_settings - it is over 20 parameters (see the GitLab API for Groups ), whenever GitLab adds a new feature to its API and you upgrade your GitLab instance, the feature is immediately configurable with GitLabForm, without updating this app, The disadvantages: you have to read the appropriate GitLab API docs when you create your initial config for some entities, like Projects or Groups, if GitLab changes something in their API syntax, you will have to apply the change in your config too - there is no abstraction layer that will protect you from it. Optional top-level keys \u00b6 The configuration can, but doesn't have to contain the following top-level keys: # list of projects that will not be processed skip_projects : - my-group/this-project-will-not-be-processed-with-gitlabform - my-group/and-this-project0too - my-group/everything-under/* # list of groups that will not be processed skip_groups : - my-other-group - this-group-and-all-sub-groups/*","title":"Configuration reference"},{"location":"reference/#configuration-reference","text":"The whole configuration for the app needs to be in a single YAML file of any name. The default location used is the current working directory and the default name is config.yml .","title":"Configuration reference"},{"location":"reference/#minimal-working-config","text":"Here is an example of a complete small config that actually does something: config_version : 3 gitlab : url : https://gitlab.yourcompany.com # alternatively use the GITLAB_TOKEN environment variable token : \"<private token of an admin user>\" projects_and_groups : \"*\" : project_settings : visibility : internal","title":"Minimal working config"},{"location":"reference/#mandatory-top-level-keys","text":"The configuration has to contain the following top-level keys: # This key is required in configs for GitLabForm version 3.x.x # This ensures that if the application behavior changes in a backward-incompatible way # you won't apply unwanted configuration to your GitLab instance. config_version : 3 # GitLab API access config gitlab : # alternatively use the GITLAB_URL environment variable for this url : https://gitlab.yourcompany.com # alternatively use the GITLAB_TOKEN environment variable for this token : \"<private token OR an OAuth2 access token of an admin user>\" # ** optional parameters - below values are defaults ** # whether the SSL certificate of your GitLab instance should be verified, # set this to `false` if you are using a self-signed certificate (not recommended) ssl_verify : true # timeout for the whole requests to the GitLab API, in seconds timeout : 10 # Configuration to apply to GitLab projects, groups and subgroups projects_and_groups : # (...) # See below.","title":"Mandatory top-level keys"},{"location":"reference/#projects-and-groups-configuration","text":"","title":"Projects and groups configuration"},{"location":"reference/#configuration-hierarchy","text":"In GitLabForm you define the configuration for your groups and projects under the projects_and_groups: top-level key, on 3 levels: Level name Key syntax Description common \"*\" the configuration that will be applied to all projects and all groups group/subgroup group/* , group/subgroup/* the configuration that will be applied to everything under a given group/subgroup, recursively (so the group/subgroup itself, all the projects in it, all the subgroups in it and all the projects in the subgroups in it) project group/project , group/subgroup/project the configuration for specific single projects Each level is optional. Order does not matter. Example: # (...) - other mandatory top-level keys projects_and_groups : \"*\" : # common-level config group_1/* : # group-level config group_1/project_1 : # project-level config group_1/project_2 : # project-level config group_1/project_3 : # project-level config group_2/* : # group-level config group_2/project_1 : # project-level config group_2/subgroup/* : # subgroup-level config group_2/subgroup/nested_project_1 : # project-level config","title":"Configuration hierarchy"},{"location":"reference/#configuration-sections","text":"Under each of the keys described above, we put configuration to apply for given entities. These keys are called \"sections\" within this app. Some configuration sections apply only to projects , some to groups . Syntax for each section is explained in detail on subpages - see links on the left.","title":"Configuration sections"},{"location":"reference/#effective-configuration","text":"To generate the effective configuration to apply for a given project or group, if it is configured on more than one level, GitLabForm will merge those configurations. If there are conflicting values in the more general (f.e. common) and more specific level (f.e. group level), then the more specific configuration will overwrite the more general one. Example: projects_and_groups : # common settings for ALL projects in ALL groups \"*\" : project_settings : default_branch : main visibility : internal group_1/* : project_settings : visibility : private With this configuration, for a project group_1/project_1 the effective configuration will be like: project_settings : default_branch : main visibility : private If the keys are added under different names in the more general and the more specific config, then they are added . So for example for sections like deploy_keys , variables , hooks on each lower level the effective configuration will contain elements from the higher levels AND the elements from the lower levels. Example: projects_and_groups : \"*\" : deploy_keys : a_shared_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDB2QKx6BPzL... title : global_key can_push : false group_1/* : deploy_keys : another_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDtbyEK66RXg... title : group_key can_push : false With this configuration, for a project group_1/project_1 the effective configuration will be: deploy_keys : a_shared_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDB2QKx6BPzL... title : global_key can_push : false another_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDtbyEK66RXg... title : group_key can_push : false Note that if you want to have a key removed , you will need to use the break-inheritance: true feature, explained in details below. For example for the following configuration: projects_and_groups : \"*\" : variables : shared_with_all_projects : &shared_with_all_projects key : SSH_PRIVATE_KEY_BASE64 value : \"LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUl (...)\" shared_with_ALMOST_all_projects : key : PROTECTED_VAR value : \"foobar-123 (...)\" protected : true group_1/project_1 : variables : << : *shared_with_all_projects Note that we used YAML anchors here to not repeat ourselves. With this configuration, for a project group_1/project_1 the effective configuration will be: group_1/project_1 : variables : shared_with_all_projects : key : SSH_PRIVATE_KEY_BASE64 value : \"LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUl (...)\" Warning : dicts are additive but arrays are not! For example with this config: projects_and_groups : \"*\" : merge_requests_approval_rules : default : approvals_required : 2 name : \"Team X or Y or super-user\" groups : - group-x - group-y users : - super-user group_1/* : merge_requests_approval_rules : default : approvals_required : 1 name : \"Team Z\" groups : - group-z users : [] With this configuration, for a project group_1/project_1 the effective configuration will be: merge_requests_approval_rules : default : approvals_required : 1 name : \"Team Z\" groups : - group-z Note that the value of groups is an array, so the effective groups contains only the single element array from group_1/* - the arrays were not added! Also note that the users is a key in the default dict, so we could not omit it. If we did that then adding would work here and users would be effective set to [super-user] . We didn't want that and that's why we did set it an explicitly empty array [] .","title":"Effective configuration"},{"location":"reference/#breaking-inheritance","text":"You can prevent inheriting configuration from the higher levels by placing inherit: false under a given section. Example: projects_and_groups : \"*\" : deploy_keys : a_shared_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDB2QKx6BPzL... title : global_key # this name is show in GitLab can_push : false group_1/* : deploy_keys : inherit : false another_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDtbyEK66RXg... title : group_key # this name is show in GitLab can_push : false For the above configuration, for a project group_1/project_1 the effective configuration for section deploy_keys is like defined for all projects and groups under * , with the more specific config in group_1/* ignored. In other words it will be like this: deploy_keys : a_shared_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDB2QKx6BPzL... title : global_key # this name is show in GitLab can_push : false Important inherit: false can be placed at ANY place in the configuration (if it makes sense).","title":"Breaking inheritance"},{"location":"reference/#skipping-sections","text":"If the only key under a section is skip: true then the given config section is not set AT ALL for a given entity. Example: projects_and_groups : \"*\" : deploy_keys : a_shared_key : key : ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDB2QKx6BPzL... title : global_key can_push : false group_1/* : deploy_keys : skip : true For the above configuration, for a project group_1/project_1 the deploy keys are not managed by GitLabForm all. Important skip: true can be placed ONLY directly under a section name.","title":"Skipping sections"},{"location":"reference/#raw-parameters-passing","text":"Some configuration sections, f.e. project_settings , will be directly send by the app via the API to specific GitLab API endpoints. This means that they key names and values are exactly like they are described in the appropriate API docs. These sections are appropriately marked in the reference docs. The advantages of this approach: you can use all the parameters from the API - for the project_settings it is over 40 parameters as of now (see the GitLab API for Projects ) while for group_settings - it is over 20 parameters (see the GitLab API for Groups ), whenever GitLab adds a new feature to its API and you upgrade your GitLab instance, the feature is immediately configurable with GitLabForm, without updating this app, The disadvantages: you have to read the appropriate GitLab API docs when you create your initial config for some entities, like Projects or Groups, if GitLab changes something in their API syntax, you will have to apply the change in your config too - there is no abstraction layer that will protect you from it.","title":"Raw parameters passing"},{"location":"reference/#optional-top-level-keys","text":"The configuration can, but doesn't have to contain the following top-level keys: # list of projects that will not be processed skip_projects : - my-group/this-project-will-not-be-processed-with-gitlabform - my-group/and-this-project0too - my-group/everything-under/* # list of groups that will not be processed skip_groups : - my-other-group - this-group-and-all-sub-groups/*","title":"Optional top-level keys"},{"location":"reference/archive_unarchive/","text":"Archive/unarchive project \u00b6 This section purpose is to archive a project or revert this process - unarchive it. There can be only one key under this section - archive - set to true or false . Important To unarchive a project you must run GitLabForm with the --include-archived-projects cli parameter, as by default the app skips the archived projects when it gathers the list of projects to process. Example: projects_and_groups : group_1/project_1 : project : archive : true","title":"Archive/unarchive"},{"location":"reference/archive_unarchive/#archiveunarchive-project","text":"This section purpose is to archive a project or revert this process - unarchive it. There can be only one key under this section - archive - set to true or false . Important To unarchive a project you must run GitLabForm with the --include-archived-projects cli parameter, as by default the app skips the archived projects when it gathers the list of projects to process. Example: projects_and_groups : group_1/project_1 : project : archive : true","title":"Archive/unarchive project"},{"location":"reference/badges/","text":"Badges \u00b6 Project Badges \u00b6 This section purpose is to manage the project badges . Key names here are just any labels, except if the key name is enforce and is set to true - then only the badges defined here will remain in the project, all other will be deleted. The values are as documented at add a badge to a project endpoint , with the appropriate placeholder tokens , but we require you to define the name of the badge. If the only non-required value is delete: true then the given badge is going to be removed. Example: projects_and_groups : group_1/project_1 : badges : coverage : name : \"Coverage\" link_url : \"http://example.com/ci_status.svg?project=%{project_path}&ref=%{default_branch}\" image_url : \"https://shields.io/my/badge\" old-badge-to-delete : name : \"a-badge\" delete : true enforce : true # optional Group Badges \u00b6 This section purpose is to manage the group badges . Key names here are just any labels, except if the key name is enforce and is set to true - then only the badges defined here will remain in the group, all other will be deleted. The values are as documented at add a badge to a group endpoint , with the appropriate placeholder tokens , but we require you to define the name of the badge. If the only non-required value is delete: true then the given badge is going to be removed. Example: projects_and_groups : group_1/* : group_badges : group-pipeline-status : name : \"Group Badge\" link_url : \"https://gitlab.yourcompany.com/%{project_path}/-/commits/%{default_branch}\" image_url : \"https://gitlab.yourcompany.com/%{project_path}/badges/%{default_branch}/pipeline.svg\" enforce : true # optional","title":"Badges"},{"location":"reference/badges/#badges","text":"","title":"Badges"},{"location":"reference/badges/#project-badges","text":"This section purpose is to manage the project badges . Key names here are just any labels, except if the key name is enforce and is set to true - then only the badges defined here will remain in the project, all other will be deleted. The values are as documented at add a badge to a project endpoint , with the appropriate placeholder tokens , but we require you to define the name of the badge. If the only non-required value is delete: true then the given badge is going to be removed. Example: projects_and_groups : group_1/project_1 : badges : coverage : name : \"Coverage\" link_url : \"http://example.com/ci_status.svg?project=%{project_path}&ref=%{default_branch}\" image_url : \"https://shields.io/my/badge\" old-badge-to-delete : name : \"a-badge\" delete : true enforce : true # optional","title":"Project Badges"},{"location":"reference/badges/#group-badges","text":"This section purpose is to manage the group badges . Key names here are just any labels, except if the key name is enforce and is set to true - then only the badges defined here will remain in the group, all other will be deleted. The values are as documented at add a badge to a group endpoint , with the appropriate placeholder tokens , but we require you to define the name of the badge. If the only non-required value is delete: true then the given badge is going to be removed. Example: projects_and_groups : group_1/* : group_badges : group-pipeline-status : name : \"Group Badge\" link_url : \"https://gitlab.yourcompany.com/%{project_path}/-/commits/%{default_branch}\" image_url : \"https://gitlab.yourcompany.com/%{project_path}/badges/%{default_branch}/pipeline.svg\" enforce : true # optional","title":"Group Badges"},{"location":"reference/ci_cd_variables/","text":"CI/CD variables \u00b6 Please note that project-level and group-level CI/CD variables are different entities in GitLab! Project CI/CD variables \u00b6 This section purpose is to manage the project-level CI/CD variables. Key names here are just any labels, except if the key name is enforce and is set to true - then only the variables defined here will remain in the project, all other will be deleted. The values are like documented at Project-Level Variables API docs , except the id . You can make the: protected variables masked variables variables limited to the scope of specific environment(s) Info Variables limited to the scope of specific environment(s) requires GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.) Example: projects_and_groups : group_1/project_1 : variables : # --- Adding/resetting a_friendly_variable_name : # this is just a label key : SSH_PRIVATE_KEY_BASE64 value : \"LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUl (...)\" # --- Adding/resetting protected variable my_protected_variable : key : PROTECTED_VAR value : \"foobar-123-123-123\" protected : true # --- Adding/resetting masked variable my_masked_variable : key : MASKED_VAR value : \"foobar-123-123-123\" masked : true # --- Adding/resetting variables per environment aws_access_key_id_for_deploying_in_production : key : APP_HOST_AWS_ACCESS_KEY_ID value : \"prod-value-1234\" protected : true masked : true environment_scope : production filter[environment_scope] : production aws_access_key_id_for_deploying_in_staging : key : APP_HOST_AWS_ACCESS_KEY_ID value : \"staging-value-1234\" protected : true masked : true environment_scope : staging filter[environment_scope] : staging # --- Deleting # the below name is not used by GitLab, it's just for you a_secret_you_want_to_remove : key : MY_SECRET delete : true enforce : true # optional Group CI/CD variables \u00b6 This section purpose is to manage the group-level CI/CD variables. Key names here are just any labels, except if the key name is enforce and is set to true - then only the variables defined here will remain in the group, all other will be deleted. The values are like documented at Group-Level Variables API docs , except the id . Although we do not provide examples like for the project-level variables, all the features like above are also supported: protected variables, masked variables, variables limited to the scope of specific environment(s). Info Variables limited to the scope of specific environment(s) requires GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.) Example: projects_and_groups : group_1/* : group_variables : # --- Adding/resetting some_secret : # this is just a label key : A_NEW_PASSWORD value : \"ThisIsAVerySecretPassword\" variable_type : env_var # or file protected : false # --- Deleting old_variable : key : PASSWORD delete : true enforce : true # optional","title":"CI/CD Variables"},{"location":"reference/ci_cd_variables/#cicd-variables","text":"Please note that project-level and group-level CI/CD variables are different entities in GitLab!","title":"CI/CD variables"},{"location":"reference/ci_cd_variables/#project-cicd-variables","text":"This section purpose is to manage the project-level CI/CD variables. Key names here are just any labels, except if the key name is enforce and is set to true - then only the variables defined here will remain in the project, all other will be deleted. The values are like documented at Project-Level Variables API docs , except the id . You can make the: protected variables masked variables variables limited to the scope of specific environment(s) Info Variables limited to the scope of specific environment(s) requires GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.) Example: projects_and_groups : group_1/project_1 : variables : # --- Adding/resetting a_friendly_variable_name : # this is just a label key : SSH_PRIVATE_KEY_BASE64 value : \"LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUl (...)\" # --- Adding/resetting protected variable my_protected_variable : key : PROTECTED_VAR value : \"foobar-123-123-123\" protected : true # --- Adding/resetting masked variable my_masked_variable : key : MASKED_VAR value : \"foobar-123-123-123\" masked : true # --- Adding/resetting variables per environment aws_access_key_id_for_deploying_in_production : key : APP_HOST_AWS_ACCESS_KEY_ID value : \"prod-value-1234\" protected : true masked : true environment_scope : production filter[environment_scope] : production aws_access_key_id_for_deploying_in_staging : key : APP_HOST_AWS_ACCESS_KEY_ID value : \"staging-value-1234\" protected : true masked : true environment_scope : staging filter[environment_scope] : staging # --- Deleting # the below name is not used by GitLab, it's just for you a_secret_you_want_to_remove : key : MY_SECRET delete : true enforce : true # optional","title":"Project CI/CD variables"},{"location":"reference/ci_cd_variables/#group-cicd-variables","text":"This section purpose is to manage the group-level CI/CD variables. Key names here are just any labels, except if the key name is enforce and is set to true - then only the variables defined here will remain in the group, all other will be deleted. The values are like documented at Group-Level Variables API docs , except the id . Although we do not provide examples like for the project-level variables, all the features like above are also supported: protected variables, masked variables, variables limited to the scope of specific environment(s). Info Variables limited to the scope of specific environment(s) requires GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.) Example: projects_and_groups : group_1/* : group_variables : # --- Adding/resetting some_secret : # this is just a label key : A_NEW_PASSWORD value : \"ThisIsAVerySecretPassword\" variable_type : env_var # or file protected : false # --- Deleting old_variable : key : PASSWORD delete : true enforce : true # optional","title":"Group CI/CD variables"},{"location":"reference/deploy_keys/","text":"Deploy keys \u00b6 Project deploy keys \u00b6 This section purpose is to manage project deploy keys . Key names here are just any labels, except if the key name is enforce and is set to true - then only the deploy keys defined here will remain in the project, all other will be deleted. The values are as documented at Deploy keys API docs , except the id . Notes: you have to always provide the whole SSH key under the key . This is a limitation of the GitLab API. You can see an example of this here in the docs . you can set the value of can_push only on the first assignment of the key or its creation. This is a limitation of the GitLab API. See this issue and comment for more information. Example: projects_and_groups : group_1/project_1 : deploy_keys : # --- Adding/resetting a_friendly_deploy_key_name : # this is just a label key : \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDB2QKx6BPzL (...)\" title : ssh_key_name_that_is_shown_in_gitlab can_push : false another_friendly_deploy_key_name : key : \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDtbyEK66RXg (...)\" title : other_ssh_key_name_that_is_shown_in_gitlab can_push : true # --- Deleting ensure_to_remove_this_one : title : different_key_title delete : true enforce : true # optional","title":"Deploy Keys"},{"location":"reference/deploy_keys/#deploy-keys","text":"","title":"Deploy keys"},{"location":"reference/deploy_keys/#project-deploy-keys","text":"This section purpose is to manage project deploy keys . Key names here are just any labels, except if the key name is enforce and is set to true - then only the deploy keys defined here will remain in the project, all other will be deleted. The values are as documented at Deploy keys API docs , except the id . Notes: you have to always provide the whole SSH key under the key . This is a limitation of the GitLab API. You can see an example of this here in the docs . you can set the value of can_push only on the first assignment of the key or its creation. This is a limitation of the GitLab API. See this issue and comment for more information. Example: projects_and_groups : group_1/project_1 : deploy_keys : # --- Adding/resetting a_friendly_deploy_key_name : # this is just a label key : \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDB2QKx6BPzL (...)\" title : ssh_key_name_that_is_shown_in_gitlab can_push : false another_friendly_deploy_key_name : key : \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDtbyEK66RXg (...)\" title : other_ssh_key_name_that_is_shown_in_gitlab can_push : true # --- Deleting ensure_to_remove_this_one : title : different_key_title delete : true enforce : true # optional","title":"Project deploy keys"},{"location":"reference/files/","text":"Files \u00b6 This section purpose is to manage files in the repository. Unlike other sections it does not correspond to any single GitLab API. You can ensure that files with specific content ARE in the repo or that they ARE NOT in the repo, in specific branch or branches. Each key in this section is a path to a file in the repo and the values are dicts with keys like: overwrite - if set to false and the file already exists, but has a different content, then it is not changed; default is true , skip_ci - if set to true then the changes to a given file will be done with commits that will not trigger the CI pipeline; default is false , branches - can be a single string all , string protected or an array of branch names, only_first_branch - if set to true then only the first branch from the list above that exists will be processed (unless you pass --strict as cli parameter to the app - then it will fail when trying to process a non-existent branch), commit_message - set this to a custom commit message that will be used by the app; optional, content - the literal contents that should be put into the target file; use this or file , file - the path to the file which content should be put into the target file; use this or content , both absolute and relative paths are supported, template - if set to false then simple templating feature will be disabled; default is true and {{ project }} will be replaced by the project name while {{ group }} by a group name, jinja_env - set this to a dict of key-values that will be used in the target file as a template, delete - if set to true then the target file will be deleted, not created. Example 1 - initialize with a default README, if custom is not provided: projects_and_groups : group_1/project_1 : files : \"README.md\" : overwrite : false branches : - develop skip_ci : true content : | This is a default README. Please replace it with a proper one! commit_message : Set default README Example 2 - unify GitLab CI pipeline config in the first branch found: develop or main: projects_and_groups : group_1/project_1 : files : \".gitlab-ci.yml\" : overwrite : true branches : - develop - main only_first_branch : true content : | stages: - test test: image: node:6 stage: test script: - npm test Example 3 - templates: projects_and_groups : group_1/project_1 : files : \"file-using-templating\" : branches : all content : | Simple templating is supported via jinja2 with two default variables {{ project }} will be replaced by project name, while {{ group }} by a group name. All occurrences will be replaced. \"file-escape-templating\" : branches : all template : no content : | {{ project }} will be rendered literally \"file-with-custom-variable\" : branches : all content : | {{ foo }} and {{ bar }} are defined by you, but currently only dict is supported for jinja_env. Group: {{ group }} and project: {{ project }} are always accessable by jinja. jinja_env : foo : \"fooz\" bar : \"barz\" Example 4 - deleting files: projects_and_groups : group_1/project_1 : files : \"some-path/garbage-file\" : delete : true branches : - develop - main only_first_branch : true skip_ci : true","title":"Files"},{"location":"reference/files/#files","text":"This section purpose is to manage files in the repository. Unlike other sections it does not correspond to any single GitLab API. You can ensure that files with specific content ARE in the repo or that they ARE NOT in the repo, in specific branch or branches. Each key in this section is a path to a file in the repo and the values are dicts with keys like: overwrite - if set to false and the file already exists, but has a different content, then it is not changed; default is true , skip_ci - if set to true then the changes to a given file will be done with commits that will not trigger the CI pipeline; default is false , branches - can be a single string all , string protected or an array of branch names, only_first_branch - if set to true then only the first branch from the list above that exists will be processed (unless you pass --strict as cli parameter to the app - then it will fail when trying to process a non-existent branch), commit_message - set this to a custom commit message that will be used by the app; optional, content - the literal contents that should be put into the target file; use this or file , file - the path to the file which content should be put into the target file; use this or content , both absolute and relative paths are supported, template - if set to false then simple templating feature will be disabled; default is true and {{ project }} will be replaced by the project name while {{ group }} by a group name, jinja_env - set this to a dict of key-values that will be used in the target file as a template, delete - if set to true then the target file will be deleted, not created. Example 1 - initialize with a default README, if custom is not provided: projects_and_groups : group_1/project_1 : files : \"README.md\" : overwrite : false branches : - develop skip_ci : true content : | This is a default README. Please replace it with a proper one! commit_message : Set default README Example 2 - unify GitLab CI pipeline config in the first branch found: develop or main: projects_and_groups : group_1/project_1 : files : \".gitlab-ci.yml\" : overwrite : true branches : - develop - main only_first_branch : true content : | stages: - test test: image: node:6 stage: test script: - npm test Example 3 - templates: projects_and_groups : group_1/project_1 : files : \"file-using-templating\" : branches : all content : | Simple templating is supported via jinja2 with two default variables {{ project }} will be replaced by project name, while {{ group }} by a group name. All occurrences will be replaced. \"file-escape-templating\" : branches : all template : no content : | {{ project }} will be rendered literally \"file-with-custom-variable\" : branches : all content : | {{ foo }} and {{ bar }} are defined by you, but currently only dict is supported for jinja_env. Group: {{ group }} and project: {{ project }} are always accessable by jinja. jinja_env : foo : \"fooz\" bar : \"barz\" Example 4 - deleting files: projects_and_groups : group_1/project_1 : files : \"some-path/garbage-file\" : delete : true branches : - develop - main only_first_branch : true skip_ci : true","title":"Files"},{"location":"reference/group_ldap_links/","text":"Group LDAP links \u00b6 Info This section requires GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.) This section purpose is to manage group membership via LDAP . Key names here are just any labels, except if the key name is enforce and is set to true - then only the group LDAP links defined here will remain in the group, all other will be deleted. Values are like documented at LDAP Group Links section of the Groups API docs , except the id . The provider should be set to a value that can be found in the GitLab web UI, here: - it's \"ldapmain\" in this example. The access_level should be set to one of the valid access levels . Example: projects_and_groups : group_1/* : group_ldap_links : devops_are_maintainers : # this is just a label provider : AD cn : devops group_access : maintainer app_devs_are_developers : # this is just a label provider : AD filter : \"(employeeType=developer)\" group_access : developer enforce : true # optional","title":"Group LDAP links"},{"location":"reference/group_ldap_links/#group-ldap-links","text":"Info This section requires GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.) This section purpose is to manage group membership via LDAP . Key names here are just any labels, except if the key name is enforce and is set to true - then only the group LDAP links defined here will remain in the group, all other will be deleted. Values are like documented at LDAP Group Links section of the Groups API docs , except the id . The provider should be set to a value that can be found in the GitLab web UI, here: - it's \"ldapmain\" in this example. The access_level should be set to one of the valid access levels . Example: projects_and_groups : group_1/* : group_ldap_links : devops_are_maintainers : # this is just a label provider : AD cn : devops group_access : maintainer app_devs_are_developers : # this is just a label provider : AD filter : \"(employeeType=developer)\" group_access : developer enforce : true # optional","title":"Group LDAP links"},{"location":"reference/integrations/","text":"Integrations \u00b6 This section purpose is to manage the project integrations . The keys name are as in the endpoints described in the GitLab Integrations API docs , f.e. pipelines-email , jira etc. The values are like the params for a given integration, as described in the same doc OR a single special value delete: true causing the given integration to be removed. Example: projects_and_groups : group_1/project_1 : integrations : slack : delete : true drone-ci : delete : true jira : active : true url : https://jira.yourcompany.com username : foo # this is required by this integration, even if it's not used password : bar # this is required by this integration, even if it's not used","title":"Integrations"},{"location":"reference/integrations/#integrations","text":"This section purpose is to manage the project integrations . The keys name are as in the endpoints described in the GitLab Integrations API docs , f.e. pipelines-email , jira etc. The values are like the params for a given integration, as described in the same doc OR a single special value delete: true causing the given integration to be removed. Example: projects_and_groups : group_1/project_1 : integrations : slack : delete : true drone-ci : delete : true jira : active : true url : https://jira.yourcompany.com username : foo # this is required by this integration, even if it's not used password : bar # this is required by this integration, even if it's not used","title":"Integrations"},{"location":"reference/members/","text":"Members \u00b6 These sections are for managing the users and groups that are members of a projects and groups . Project members \u00b6 There are 3 keys that can be set in the members section: groups - to make other groups members of a given group. Here the key names are group paths and values are as described in the share project with a group endpoint of the Projects API , users - to add single users. Here the key names are usernames and the values are as described in the add member to a group or project endpoint of the Group and project members API , enforce - if set to true then this project will have ONLY the users and groups listed in the configuration as the direct members (so this setting will NOT affect the members inherited f.e. from a group that contains this project); default is false . Note: there has to be at least 1 user/group with \"owner\" access level per project - it's required by GitLab. Example: projects_and_groups : group_1/project_1 : members : groups : my-group : group_access : maintainer my-other-group/subgroup : group_access : maintainer users : my-user : access_level : maintainer expires_at : 2025-09-26 enforce : true Group members \u00b6 There are 3 keys that can be set in the group_members section: groups - to make other groups members of a given group. Here the key names are group paths and values are as described in the create a link to share a group with another group endpoint of the Groups API , users - to add single users. Here the key names are usernames and the values are as described in the add member to a group or project endpoint of the Group and project members API , enforce - if set to true then removing a user or group from this config will also remove them from the group; default is false . Note: there has to be at least 1 user/group with \"owner\" access level per group - it's required by GitLab. Example: projects_and_groups : group_1/* : group_members : groups : another-group : group_access : no access users : my-user : access_level : owner enforce : true","title":"Members"},{"location":"reference/members/#members","text":"These sections are for managing the users and groups that are members of a projects and groups .","title":"Members"},{"location":"reference/members/#project-members","text":"There are 3 keys that can be set in the members section: groups - to make other groups members of a given group. Here the key names are group paths and values are as described in the share project with a group endpoint of the Projects API , users - to add single users. Here the key names are usernames and the values are as described in the add member to a group or project endpoint of the Group and project members API , enforce - if set to true then this project will have ONLY the users and groups listed in the configuration as the direct members (so this setting will NOT affect the members inherited f.e. from a group that contains this project); default is false . Note: there has to be at least 1 user/group with \"owner\" access level per project - it's required by GitLab. Example: projects_and_groups : group_1/project_1 : members : groups : my-group : group_access : maintainer my-other-group/subgroup : group_access : maintainer users : my-user : access_level : maintainer expires_at : 2025-09-26 enforce : true","title":"Project members"},{"location":"reference/members/#group-members","text":"There are 3 keys that can be set in the group_members section: groups - to make other groups members of a given group. Here the key names are group paths and values are as described in the create a link to share a group with another group endpoint of the Groups API , users - to add single users. Here the key names are usernames and the values are as described in the add member to a group or project endpoint of the Group and project members API , enforce - if set to true then removing a user or group from this config will also remove them from the group; default is false . Note: there has to be at least 1 user/group with \"owner\" access level per group - it's required by GitLab. Example: projects_and_groups : group_1/* : group_members : groups : another-group : group_access : no access users : my-user : access_level : owner enforce : true","title":"Group members"},{"location":"reference/merge_requests/","text":"Merge Requests \u00b6 Info This section requires GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.) This section purpose is to manage the Merge Requests settings. The settings under the approvals key are as documented at GitLab's Merge Request approvals API . The approvers and approver_groups are both optional. If any of these are set, GitLabForm starts to manage an approval rule named \"Approvers (configured using GitLabForm)\". Under the approvers there should be an array of usernames, under the approver_groups - array of group/subgroup paths. The remove_other_approval_rules key is optional and if it is set to true then any other approval rules that might exist in the project, other than the one mentioned above, will be deleted. Note Some Merge Requests-related settings are also set in the project settings . Example: projects_and_groups : group_1/project_1 : merge_requests : approvals : approvals_before_merge : 2 reset_approvals_on_push : true disable_overriding_approvers_per_merge_request : true approvers : - user1 - user2 approver_groups : - my-group - my-group1/subgroup - my-group2/subgroup/subsubgroup remove_other_approval_rules : false","title":"Merge Requests"},{"location":"reference/merge_requests/#merge-requests","text":"Info This section requires GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.) This section purpose is to manage the Merge Requests settings. The settings under the approvals key are as documented at GitLab's Merge Request approvals API . The approvers and approver_groups are both optional. If any of these are set, GitLabForm starts to manage an approval rule named \"Approvers (configured using GitLabForm)\". Under the approvers there should be an array of usernames, under the approver_groups - array of group/subgroup paths. The remove_other_approval_rules key is optional and if it is set to true then any other approval rules that might exist in the project, other than the one mentioned above, will be deleted. Note Some Merge Requests-related settings are also set in the project settings . Example: projects_and_groups : group_1/project_1 : merge_requests : approvals : approvals_before_merge : 2 reset_approvals_on_push : true disable_overriding_approvers_per_merge_request : true approvers : - user1 - user2 approver_groups : - my-group - my-group1/subgroup - my-group2/subgroup/subsubgroup remove_other_approval_rules : false","title":"Merge Requests"},{"location":"reference/pipeline_schedules/","text":"Pipeline schedules \u00b6 This section purpose is to manage the pipeline schedules . The keys name are schedule descriptions and values are parameters described in the Pipeline schedules API docs , except the id . Additionally, under a variables key you can add the pipeline schedule variables. The syntax here is that key name is the variable name, the value is under value and the optional variable_type can be set to env_var (default) or file . Warning If there are multiple pipeline schedules with the same description in a single project, this will cause those schedules to be DELETED and replaced with the one from the configuration. Example: projects_and_groups : group_1/project_1 : schedules : \"Some schedule\" : ref : main cron : \"0 * * * MON-FRI\" cron_timezone : \"London\" active : false \"Another schedule\" : ref : develop cron : \"0 * * * *\" variables : some_variable : value : some_value variable_type : file other_variable : value : another_value \"Obsolete schedule\" : delete : true","title":"Pipeline schedules"},{"location":"reference/pipeline_schedules/#pipeline-schedules","text":"This section purpose is to manage the pipeline schedules . The keys name are schedule descriptions and values are parameters described in the Pipeline schedules API docs , except the id . Additionally, under a variables key you can add the pipeline schedule variables. The syntax here is that key name is the variable name, the value is under value and the optional variable_type can be set to env_var (default) or file . Warning If there are multiple pipeline schedules with the same description in a single project, this will cause those schedules to be DELETED and replaced with the one from the configuration. Example: projects_and_groups : group_1/project_1 : schedules : \"Some schedule\" : ref : main cron : \"0 * * * MON-FRI\" cron_timezone : \"London\" active : false \"Another schedule\" : ref : develop cron : \"0 * * * *\" variables : some_variable : value : some_value variable_type : file other_variable : value : another_value \"Obsolete schedule\" : delete : true","title":"Pipeline schedules"},{"location":"reference/protected_branches/","text":"Protected branches \u00b6 This section purpose is to manage the protected branches . Common features \u00b6 The key names here may be: exact branch names, branch names using wildcards , The values: have to contain a protected key set to true or false , if protected: true , then you can configure the protection using: push_access_level , merge_access_level , unprotect_access_level keys, each set to one of the valid access levels that will be the minimal access level required for a given action, (optional) allow_force_push key set to true or false , Example: projects_and_groups : group_1/project_1 : branches : # Keep this branch unprotected develop : protected : false # Allow merging by developers, but no direct commits main : protected : true push_access_level : no access merge_access_level : developer unprotect_access_level : maintainer # Disallow any changes to this branch special_protected_branch : protected : true push_access_level : no access merge_access_level : no access unprotect_access_level : maintainer # Protect branches with names matching wildcards '*-some-name-suffix' : protected : true push_access_level : no access merge_access_level : developer unprotect_access_level : maintainer # Protect the branch but allow force pushes allow_to_force_push : protected : true push_access_level : no access merge_access_level : developer unprotect_access_level : maintainer allow_force_push : true Premium-only features \u00b6 Info Below syntax and features require GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.) In GitLab Premium instances you can also use the following extra keys under each branch: code_owner_approval_required set to true or false , allowed_to_push , allowed_to_merge , allowed_to_unprotect keys that can be set to the arrays containing any combination of: user set to username, user_id set to user id, group set to group name (path), group_id set to group id, access_level set to valid access level Note that you should NOT use both *_access_level and allowed_to_* keys - the result could be ambiguous, please choose the first or the second set. Example: projects_and_groups : group_1/project_1 : branches : # Require code approvals, merge for developers, no direct commits extra : protected : true push_access_level : no access merge_access_level : developer unprotect_access_level : maintainer code_owner_approval_required : true # Allow specific users and groups to operate on this branch special : protected : true allowed_to_push : - user : jsmith # you can use usernames... - user : bdoe - group : another-group # ...or group names (paths)... allowed_to_merge : - user_id : 15 # ...or user ids, if you know them... - group_id : 456 # ...or group ids, if you know them... allowed_to_unprotect : - access_level : maintainer # ...or the whole access levels","title":"Branches"},{"location":"reference/protected_branches/#protected-branches","text":"This section purpose is to manage the protected branches .","title":"Protected branches"},{"location":"reference/protected_branches/#common-features","text":"The key names here may be: exact branch names, branch names using wildcards , The values: have to contain a protected key set to true or false , if protected: true , then you can configure the protection using: push_access_level , merge_access_level , unprotect_access_level keys, each set to one of the valid access levels that will be the minimal access level required for a given action, (optional) allow_force_push key set to true or false , Example: projects_and_groups : group_1/project_1 : branches : # Keep this branch unprotected develop : protected : false # Allow merging by developers, but no direct commits main : protected : true push_access_level : no access merge_access_level : developer unprotect_access_level : maintainer # Disallow any changes to this branch special_protected_branch : protected : true push_access_level : no access merge_access_level : no access unprotect_access_level : maintainer # Protect branches with names matching wildcards '*-some-name-suffix' : protected : true push_access_level : no access merge_access_level : developer unprotect_access_level : maintainer # Protect the branch but allow force pushes allow_to_force_push : protected : true push_access_level : no access merge_access_level : developer unprotect_access_level : maintainer allow_force_push : true","title":"Common features"},{"location":"reference/protected_branches/#premium-only-features","text":"Info Below syntax and features require GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.) In GitLab Premium instances you can also use the following extra keys under each branch: code_owner_approval_required set to true or false , allowed_to_push , allowed_to_merge , allowed_to_unprotect keys that can be set to the arrays containing any combination of: user set to username, user_id set to user id, group set to group name (path), group_id set to group id, access_level set to valid access level Note that you should NOT use both *_access_level and allowed_to_* keys - the result could be ambiguous, please choose the first or the second set. Example: projects_and_groups : group_1/project_1 : branches : # Require code approvals, merge for developers, no direct commits extra : protected : true push_access_level : no access merge_access_level : developer unprotect_access_level : maintainer code_owner_approval_required : true # Allow specific users and groups to operate on this branch special : protected : true allowed_to_push : - user : jsmith # you can use usernames... - user : bdoe - group : another-group # ...or group names (paths)... allowed_to_merge : - user_id : 15 # ...or user ids, if you know them... - group_id : 456 # ...or group ids, if you know them... allowed_to_unprotect : - access_level : maintainer # ...or the whole access levels","title":"Premium-only features"},{"location":"reference/protected_environments/","text":"Protected environments \u00b6 Info This section requires GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.) This section purpose is to manage the project protected environments . Key names here are just any labels, except if the key name is enforce and is set to true - then only the protected environments defined here will remain in the project, all other will be deleted. The supported values are like documented in the protect environment endpoint of the Protected environments API , with the following changes: user with a username can be used instead of user_id with a user id, group with a group name can be used instead of group_id with a group id. access_level can have a string from the valid access levels as a value instead of just a number, using approval_rules may work but this has not been tested yet, Example: projects_and_groups : group_1/project_1 : protected_environments : enforce : true env_1 : # name of the environment deploy_access_levels : &example_anchor_to_reuse_this_cfg - access_level : maintainer - user : johndoe - user_id : 1234 env_2 : # name of the environment deploy_access_levels : *example_anchor_to_reuse_this_cfg","title":"Protected environments"},{"location":"reference/protected_environments/#protected-environments","text":"Info This section requires GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.) This section purpose is to manage the project protected environments . Key names here are just any labels, except if the key name is enforce and is set to true - then only the protected environments defined here will remain in the project, all other will be deleted. The supported values are like documented in the protect environment endpoint of the Protected environments API , with the following changes: user with a username can be used instead of user_id with a user id, group with a group name can be used instead of group_id with a group id. access_level can have a string from the valid access levels as a value instead of just a number, using approval_rules may work but this has not been tested yet, Example: projects_and_groups : group_1/project_1 : protected_environments : enforce : true env_1 : # name of the environment deploy_access_levels : &example_anchor_to_reuse_this_cfg - access_level : maintainer - user : johndoe - user_id : 1234 env_2 : # name of the environment deploy_access_levels : *example_anchor_to_reuse_this_cfg","title":"Protected environments"},{"location":"reference/push_rules/","text":"Push rules \u00b6 Info This section requires GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.) Project Push rules \u00b6 This section purpose is to manage the project push rules . The settings should be as documented at GitLab's Push rules section of the Projects API docs , except the id . Example: projects_and_groups : group_1/project_1 : project_push_rules : commit_message_regex : 'Fixes \\d +' branch_name_regex : \"\" deny_delete_tag : false member_check : false prevent_secrets : false author_email_regex : \"\" file_name_regex : \"\" max_file_size : 0 # in MB, 0 means unlimited","title":"Push rules"},{"location":"reference/push_rules/#push-rules","text":"Info This section requires GitLab Premium (paid). (This is a GitLab's limitation, not GitLabForm's.)","title":"Push rules"},{"location":"reference/push_rules/#project-push-rules","text":"This section purpose is to manage the project push rules . The settings should be as documented at GitLab's Push rules section of the Projects API docs , except the id . Example: projects_and_groups : group_1/project_1 : project_push_rules : commit_message_regex : 'Fixes \\d +' branch_name_regex : \"\" deny_delete_tag : false member_check : false prevent_secrets : false author_email_regex : \"\" file_name_regex : \"\" max_file_size : 0 # in MB, 0 means unlimited","title":"Project Push rules"},{"location":"reference/resource_groups/","text":"Resource Groups \u00b6 Prerequisite \u00b6 A resource group must exist before the process mode can be updated. Add a resource group to a project by configuring it in your project's gitlab-ci.yml file. For more information, visit the appropriate GitLab's docs . Update Process Mode \u00b6 This section's purpose is to manage the resource group process modes . The key names are the resource group names associated with the project. The value for each key name is a key-value pair, with process_mode as the key and the value is one of the process modes defined here . Example: projects_and_groups : group_1/project_1 : resource_groups : staging : process_mode : oldest_first production : process_mode : newest_first","title":"Resource groups"},{"location":"reference/resource_groups/#resource-groups","text":"","title":"Resource Groups"},{"location":"reference/resource_groups/#prerequisite","text":"A resource group must exist before the process mode can be updated. Add a resource group to a project by configuring it in your project's gitlab-ci.yml file. For more information, visit the appropriate GitLab's docs .","title":"Prerequisite"},{"location":"reference/resource_groups/#update-process-mode","text":"This section's purpose is to manage the resource group process modes . The key names are the resource group names associated with the project. The value for each key name is a key-value pair, with process_mode as the key and the value is one of the process modes defined here . Example: projects_and_groups : group_1/project_1 : resource_groups : staging : process_mode : oldest_first production : process_mode : newest_first","title":"Update Process Mode"},{"location":"reference/settings/","text":"Settings \u00b6 Project Settings \u00b6 This section purpose is to manage the project settings . The settings should be as documented at GitLab's Project API docs , except the id . You can provide any number of the settings from there - if you don't provide a setting then it will be not changed. Note that some keys and values can be very complex here - see the Container Registry cleanup policies under the container_expiration_policy_attributes key in the code below as an example. Note Some Merge Requests -related settings are also set here. Example: projects_and_groups : group_1/project_1 : project_settings : default_branch : main builds_access_level : enabled visibility : internal only_allow_merge_if_pipeline_succeeds : true only_allow_merge_if_all_discussions_are_resolved : true container_expiration_policy_attributes : cadence : \"1month\" enabled : true keep_n : 1 older_than : \"14d\" name_regex : \"\" name_regex_delete : \".*\" name_regex_keep : \".*-main\" # (...) Group Settings \u00b6 This section purpose is to manage the group settings . The settings should be as documented at GitLab's Groups API docs , except the id . You can provide any number of the settings from there - if you don't provide a setting then it will be not changed. projects_and_groups : group_1/* : # configures settings for the 'group-with-spammy-projects' group group_settings : # keys and values here are as described at https://docs.gitlab.com/ee/api/groups.html#update-group emails_disabled : true","title":"Settings"},{"location":"reference/settings/#settings","text":"","title":"Settings"},{"location":"reference/settings/#project-settings","text":"This section purpose is to manage the project settings . The settings should be as documented at GitLab's Project API docs , except the id . You can provide any number of the settings from there - if you don't provide a setting then it will be not changed. Note that some keys and values can be very complex here - see the Container Registry cleanup policies under the container_expiration_policy_attributes key in the code below as an example. Note Some Merge Requests -related settings are also set here. Example: projects_and_groups : group_1/project_1 : project_settings : default_branch : main builds_access_level : enabled visibility : internal only_allow_merge_if_pipeline_succeeds : true only_allow_merge_if_all_discussions_are_resolved : true container_expiration_policy_attributes : cadence : \"1month\" enabled : true keep_n : 1 older_than : \"14d\" name_regex : \"\" name_regex_delete : \".*\" name_regex_keep : \".*-main\" # (...)","title":"Project Settings"},{"location":"reference/settings/#group-settings","text":"This section purpose is to manage the group settings . The settings should be as documented at GitLab's Groups API docs , except the id . You can provide any number of the settings from there - if you don't provide a setting then it will be not changed. projects_and_groups : group_1/* : # configures settings for the 'group-with-spammy-projects' group group_settings : # keys and values here are as described at https://docs.gitlab.com/ee/api/groups.html#update-group emails_disabled : true","title":"Group Settings"},{"location":"reference/tags_protection/","text":"Tags protection \u00b6 This section purpose is to protect and unprotect the project tags. It works using the Protected tags API and its syntax is loosely based on it. The keys are the exact names of the tag or wildcards. The values are: protected : true or false , (optional) create_access_level : minimal access levels allowed to create (default: maintainer , allowed: no access , developer , maintainer ) Example: projects_and_groups : group_1/project_1 : tags : \"v*\" : protected : true create_access_level : developer \"some-old-tag\" : protected : false","title":"Tags protection"},{"location":"reference/tags_protection/#tags-protection","text":"This section purpose is to protect and unprotect the project tags. It works using the Protected tags API and its syntax is loosely based on it. The keys are the exact names of the tag or wildcards. The values are: protected : true or false , (optional) create_access_level : minimal access levels allowed to create (default: maintainer , allowed: no access , developer , maintainer ) Example: projects_and_groups : group_1/project_1 : tags : \"v*\" : protected : true create_access_level : developer \"some-old-tag\" : protected : false","title":"Tags protection"},{"location":"reference/webhooks/","text":"Webhooks \u00b6 This section purpose is to manage the Webhooks (aka Project Hooks). The key names here are webhook URLs and values are as parameters described at edit project hooks endpoint , except the id and hook_id . If the only value is delete: true then the given webhook is going to be removed. Example: projects_and_groups : group_1/project_1 : hooks : \"http://host.domain.com/some-old-hook-you-want-to-remove-from-config\" : delete : true \"http://127.0.0.1:5000/hooks/merge-request\" : push_events : false # this is set to true by GitLab API by default merge_requests_events : true token : some_secret_auth_token","title":"Webhooks"},{"location":"reference/webhooks/#webhooks","text":"This section purpose is to manage the Webhooks (aka Project Hooks). The key names here are webhook URLs and values are as parameters described at edit project hooks endpoint , except the id and hook_id . If the only value is delete: true then the given webhook is going to be removed. Example: projects_and_groups : group_1/project_1 : hooks : \"http://host.domain.com/some-old-hook-you-want-to-remove-from-config\" : delete : true \"http://127.0.0.1:5000/hooks/merge-request\" : push_events : false # this is set to true by GitLab API by default merge_requests_events : true token : some_secret_auth_token","title":"Webhooks"}]}